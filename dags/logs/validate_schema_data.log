2024-11-01 20:50:25,991 - INFO - Starting data download process
2024-11-01 20:50:25,991 - INFO - Starting data download process
2024-11-01 20:50:28,863 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 20:50:28,863 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 20:50:28,942 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 20:50:28,942 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 20:50:51,127 - INFO - Starting data loading process
2024-11-01 20:50:51,127 - INFO - Starting data loading process
2024-11-01 20:50:51,138 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 20:50:51,138 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 20:50:51,222 - INFO - Pickle file loaded successfully
2024-11-01 20:50:51,222 - INFO - Pickle file loaded successfully
2024-11-01 20:50:52,478 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 20:50:52,478 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:30:24,312 - INFO - Starting data download process
2024-11-01 21:30:24,312 - INFO - Starting data download process
2024-11-01 21:30:28,123 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:30:28,123 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:30:28,250 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:30:28,250 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:30:47,321 - INFO - Starting data loading process
2024-11-01 21:30:47,321 - INFO - Starting data loading process
2024-11-01 21:30:47,328 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:30:47,328 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:30:47,425 - INFO - Pickle file loaded successfully
2024-11-01 21:30:47,425 - INFO - Pickle file loaded successfully
2024-11-01 21:30:48,630 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:30:48,630 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:31:03,423 - INFO - Data loaded from /opt/airflow/data/processed/raw_data.pkl. Type: <class 'bytes'>
2024-11-01 21:31:03,423 - INFO - Data loaded from /opt/airflow/data/processed/raw_data.pkl. Type: <class 'bytes'>
2024-11-01 21:37:04,591 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:37:04,591 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:37:14,727 - INFO - Starting data download process
2024-11-01 21:37:14,727 - INFO - Starting data download process
2024-11-01 21:37:19,233 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:37:19,233 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:37:19,279 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:37:19,279 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:37:39,299 - INFO - Starting data loading process
2024-11-01 21:37:39,299 - INFO - Starting data loading process
2024-11-01 21:37:39,307 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:37:39,307 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:37:39,372 - INFO - Pickle file loaded successfully
2024-11-01 21:37:39,372 - INFO - Pickle file loaded successfully
2024-11-01 21:37:40,444 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:37:40,444 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:38:02,260 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:38:02,260 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:50:48,011 - INFO - Starting data download process
2024-11-01 21:50:48,011 - INFO - Starting data download process
2024-11-01 21:50:54,394 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:50:54,394 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:50:54,448 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:50:54,448 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:51:03,211 - INFO - Starting data loading process
2024-11-01 21:51:03,211 - INFO - Starting data loading process
2024-11-01 21:51:03,218 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:51:03,218 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:51:03,277 - INFO - Pickle file loaded successfully
2024-11-01 21:51:03,277 - INFO - Pickle file loaded successfully
2024-11-01 21:51:03,906 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:51:03,906 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:56:30,244 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 21:56:30,244 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 21:56:30,253 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,253 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,567 - INFO - Generated training data statistics.
2024-11-01 21:56:30,567 - INFO - Generated training data statistics.
2024-11-01 21:56:30,591 - INFO - Inferred schema from training data statistics.
2024-11-01 21:56:30,591 - INFO - Inferred schema from training data statistics.
2024-11-01 21:56:30,700 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 21:56:30,700 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 21:56:30,711 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,711 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,960 - INFO - Generated training data statistics.
2024-11-01 21:56:30,960 - INFO - Generated training data statistics.
2024-11-01 21:56:30,966 - INFO - Statistics visualization complete.
2024-11-01 21:56:30,966 - INFO - Statistics visualization complete.
2024-11-01 21:56:39,073 - INFO - Starting data processing...
2024-11-01 21:56:39,073 - INFO - Starting data processing...
2024-11-01 21:56:39,080 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 21:56:39,080 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 21:56:59,095 - INFO - Starting data processing
2024-11-01 21:56:59,095 - INFO - Starting data processing
2024-11-01 21:56:59,103 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:56:59,103 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:56:59,388 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 21:56:59,388 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 21:56:59,672 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 21:56:59,672 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 21:56:59,784 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 21:56:59,784 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 21:56:59,868 - INFO - No duplicate rows found.
2024-11-01 21:56:59,868 - INFO - No duplicate rows found.
2024-11-01 21:57:02,005 - INFO - Percentage of null or unknown values in each column:
2024-11-01 21:57:02,005 - INFO - Percentage of null or unknown values in each column:
2024-11-01 21:57:02,014 - INFO - age: 0.00%
2024-11-01 21:57:02,014 - INFO - age: 0.00%
2024-11-01 21:57:02,020 - INFO - job: 0.64%
2024-11-01 21:57:02,020 - INFO - job: 0.64%
2024-11-01 21:57:02,027 - INFO - marital: 0.00%
2024-11-01 21:57:02,027 - INFO - marital: 0.00%
2024-11-01 21:57:02,033 - INFO - education: 4.11%
2024-11-01 21:57:02,033 - INFO - education: 4.11%
2024-11-01 21:57:02,039 - INFO - default: 0.00%
2024-11-01 21:57:02,039 - INFO - default: 0.00%
2024-11-01 21:57:02,047 - INFO - balance: 0.00%
2024-11-01 21:57:02,047 - INFO - balance: 0.00%
2024-11-01 21:57:02,053 - INFO - housing: 0.00%
2024-11-01 21:57:02,053 - INFO - housing: 0.00%
2024-11-01 21:57:02,060 - INFO - loan: 0.00%
2024-11-01 21:57:02,060 - INFO - loan: 0.00%
2024-11-01 21:57:02,068 - INFO - contact: 28.80%
2024-11-01 21:57:02,068 - INFO - contact: 28.80%
2024-11-01 21:57:02,075 - INFO - day: 0.00%
2024-11-01 21:57:02,075 - INFO - day: 0.00%
2024-11-01 21:57:02,082 - INFO - month: 0.00%
2024-11-01 21:57:02,082 - INFO - month: 0.00%
2024-11-01 21:57:02,088 - INFO - duration: 0.00%
2024-11-01 21:57:02,088 - INFO - duration: 0.00%
2024-11-01 21:57:02,098 - INFO - campaign: 0.00%
2024-11-01 21:57:02,098 - INFO - campaign: 0.00%
2024-11-01 21:57:02,105 - INFO - pdays: 0.00%
2024-11-01 21:57:02,105 - INFO - pdays: 0.00%
2024-11-01 21:57:02,113 - INFO - previous: 0.00%
2024-11-01 21:57:02,113 - INFO - previous: 0.00%
2024-11-01 21:57:02,119 - INFO - poutcome: 81.75%
2024-11-01 21:57:02,119 - INFO - poutcome: 81.75%
2024-11-01 21:57:02,127 - INFO - y: 0.00%
2024-11-01 21:57:02,127 - INFO - y: 0.00%
2024-11-01 21:57:02,149 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 21:57:02,149 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 21:57:02,287 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 21:57:02,287 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 21:57:02,416 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 21:57:02,416 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 21:57:02,522 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 21:57:02,522 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 21:57:02,534 - INFO - Data processing completed successfully
2024-11-01 21:57:02,534 - INFO - Data processing completed successfully
2024-11-01 21:57:33,027 - INFO - Starting EDA process
2024-11-01 21:57:33,027 - INFO - Starting EDA process
2024-11-01 21:57:33,031 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 21:57:33,031 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 21:57:33,146 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:33,146 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:33,161 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 21:57:33,161 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 21:57:33,165 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 21:57:33,165 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 21:57:33,359 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 21:57:33,359 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 21:57:33,370 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 21:57:33,370 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 21:57:33,547 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 21:57:33,547 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 21:57:33,705 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 21:57:33,705 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 21:57:33,855 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 21:57:33,855 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 21:57:34,015 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 21:57:34,015 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 21:57:34,027 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 21:57:34,027 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 21:57:34,252 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 21:57:34,252 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 21:57:34,441 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 21:57:34,441 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 21:57:34,615 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 21:57:34,615 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 21:57:34,769 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 21:57:34,769 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 21:57:34,966 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 21:57:34,966 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 21:57:40,351 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:57:40,351 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:57:40,363 - INFO - EDA process completed successfully
2024-11-01 21:57:40,363 - INFO - EDA process completed successfully
2024-11-01 21:57:55,869 - INFO - Starting categorical encoding process
2024-11-01 21:57:55,869 - INFO - Starting categorical encoding process
2024-11-01 21:57:56,193 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:56,193 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:56,202 - INFO - Column datatypes:
2024-11-01 21:57:56,202 - INFO - Column datatypes:
2024-11-01 21:57:56,214 - INFO - age: float64
2024-11-01 21:57:56,214 - INFO - age: float64
2024-11-01 21:57:56,231 - INFO - job: string
2024-11-01 21:57:56,231 - INFO - job: string
2024-11-01 21:57:56,240 - INFO - marital: string
2024-11-01 21:57:56,240 - INFO - marital: string
2024-11-01 21:57:56,247 - INFO - education: string
2024-11-01 21:57:56,247 - INFO - education: string
2024-11-01 21:57:56,253 - INFO - default: string
2024-11-01 21:57:56,253 - INFO - default: string
2024-11-01 21:57:56,260 - INFO - balance: float64
2024-11-01 21:57:56,260 - INFO - balance: float64
2024-11-01 21:57:56,266 - INFO - housing: string
2024-11-01 21:57:56,266 - INFO - housing: string
2024-11-01 21:57:56,273 - INFO - loan: string
2024-11-01 21:57:56,273 - INFO - loan: string
2024-11-01 21:57:56,281 - INFO - contact: string
2024-11-01 21:57:56,281 - INFO - contact: string
2024-11-01 21:57:56,288 - INFO - day: float64
2024-11-01 21:57:56,288 - INFO - day: float64
2024-11-01 21:57:56,295 - INFO - month: string
2024-11-01 21:57:56,295 - INFO - month: string
2024-11-01 21:57:56,303 - INFO - duration: float64
2024-11-01 21:57:56,303 - INFO - duration: float64
2024-11-01 21:57:56,311 - INFO - campaign: float64
2024-11-01 21:57:56,311 - INFO - campaign: float64
2024-11-01 21:57:56,319 - INFO - pdays: float64
2024-11-01 21:57:56,319 - INFO - pdays: float64
2024-11-01 21:57:56,328 - INFO - previous: float64
2024-11-01 21:57:56,328 - INFO - previous: float64
2024-11-01 21:57:56,338 - INFO - y: string
2024-11-01 21:57:56,338 - INFO - y: string
2024-11-01 21:57:56,382 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 21:57:56,382 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 21:57:56,445 - INFO - Encoded column: job
2024-11-01 21:57:56,445 - INFO - Encoded column: job
2024-11-01 21:57:56,484 - INFO - Encoded column: marital
2024-11-01 21:57:56,484 - INFO - Encoded column: marital
2024-11-01 21:57:56,524 - INFO - Encoded column: education
2024-11-01 21:57:56,524 - INFO - Encoded column: education
2024-11-01 21:57:56,551 - INFO - Encoded column: default
2024-11-01 21:57:56,551 - INFO - Encoded column: default
2024-11-01 21:57:56,581 - INFO - Encoded column: housing
2024-11-01 21:57:56,581 - INFO - Encoded column: housing
2024-11-01 21:57:56,606 - INFO - Encoded column: loan
2024-11-01 21:57:56,606 - INFO - Encoded column: loan
2024-11-01 21:57:56,629 - INFO - Encoded column: contact
2024-11-01 21:57:56,629 - INFO - Encoded column: contact
2024-11-01 21:57:56,660 - INFO - Encoded column: month
2024-11-01 21:57:56,660 - INFO - Encoded column: month
2024-11-01 21:57:56,686 - INFO - Encoded column: y
2024-11-01 21:57:56,686 - INFO - Encoded column: y
2024-11-01 21:57:57,140 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 21:57:57,140 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 21:57:57,187 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:57:57,187 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:57:57,191 - INFO - Categorical encoding process completed successfully
2024-11-01 21:57:57,191 - INFO - Categorical encoding process completed successfully
2024-11-01 21:58:17,230 - INFO - Starting correlation analysis
2024-11-01 21:58:17,230 - INFO - Starting correlation analysis
2024-11-01 21:58:17,240 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:17,240 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:17,349 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:17,349 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:17,444 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 21:58:17,444 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 21:58:17,460 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 21:58:17,460 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 21:58:17,477 - INFO - No highly correlated pairs found.
2024-11-01 21:58:17,477 - INFO - No highly correlated pairs found.
2024-11-01 21:58:19,067 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:58:19,067 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:58:19,072 - INFO - Correlation analysis completed successfully
2024-11-01 21:58:19,072 - INFO - Correlation analysis completed successfully
2024-11-01 21:58:28,027 - INFO - Starting SMOTE analysis
2024-11-01 21:58:28,027 - INFO - Starting SMOTE analysis
2024-11-01 21:58:28,030 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:28,030 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:28,075 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:28,075 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:28,089 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 21:58:28,089 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 21:58:28,208 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 21:58:28,208 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 21:58:28,212 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 21:58:28,212 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 21:58:28,218 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 21:58:28,218 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 21:58:29,743 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 21:58:29,743 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 21:58:30,871 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 21:58:30,871 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 21:58:31,446 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 21:58:31,446 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 21:58:31,702 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 21:58:31,702 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 21:58:31,760 - INFO - SMOTE analysis completed successfully
2024-11-01 21:58:31,760 - INFO - SMOTE analysis completed successfully
2024-11-01 22:32:54,515 - INFO - Starting data download process
2024-11-01 22:32:54,515 - INFO - Starting data download process
2024-11-01 22:32:57,553 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:32:57,553 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:32:57,635 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:32:57,635 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:33:17,432 - INFO - Starting data loading process
2024-11-01 22:33:17,432 - INFO - Starting data loading process
2024-11-01 22:33:17,442 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:33:17,442 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:33:17,508 - INFO - Pickle file loaded successfully
2024-11-01 22:33:17,508 - INFO - Pickle file loaded successfully
2024-11-01 22:33:18,620 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:33:18,620 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:38:38,519 - INFO - Starting data download process
2024-11-01 22:38:38,519 - INFO - Starting data download process
2024-11-01 22:38:41,242 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:38:41,242 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:38:41,367 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:38:41,367 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:38:55,043 - INFO - Starting data loading process
2024-11-01 22:38:55,043 - INFO - Starting data loading process
2024-11-01 22:38:55,050 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:38:55,050 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:38:55,112 - INFO - Pickle file loaded successfully
2024-11-01 22:38:55,112 - INFO - Pickle file loaded successfully
2024-11-01 22:38:55,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:38:55,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:47:23,050 - INFO - Starting data download process
2024-11-01 22:47:23,050 - INFO - Starting data download process
2024-11-01 22:47:25,665 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:47:25,665 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:47:25,726 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:47:25,726 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:47:40,951 - INFO - Starting data loading process
2024-11-01 22:47:40,951 - INFO - Starting data loading process
2024-11-01 22:47:40,958 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:47:40,958 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:47:41,016 - INFO - Pickle file loaded successfully
2024-11-01 22:47:41,016 - INFO - Pickle file loaded successfully
2024-11-01 22:47:41,661 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:47:41,661 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:47:55,181 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 22:47:55,181 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 22:55:47,907 - INFO - Starting data download process
2024-11-01 22:55:47,907 - INFO - Starting data download process
2024-11-01 22:55:52,874 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:55:52,874 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:55:53,337 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:55:53,337 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:56:11,546 - INFO - Starting data loading process
2024-11-01 22:56:11,546 - INFO - Starting data loading process
2024-11-01 22:56:11,554 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:56:11,554 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:56:11,757 - INFO - Pickle file loaded successfully
2024-11-01 22:56:11,757 - INFO - Pickle file loaded successfully
2024-11-01 22:56:12,563 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:56:12,563 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:03:24,914 - INFO - Starting data download process
2024-11-01 23:03:24,914 - INFO - Starting data download process
2024-11-01 23:03:29,472 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:03:29,472 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:03:29,566 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:03:29,566 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:03:49,417 - INFO - Starting data loading process
2024-11-01 23:03:49,417 - INFO - Starting data loading process
2024-11-01 23:03:49,426 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:03:49,426 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:03:49,498 - INFO - Pickle file loaded successfully
2024-11-01 23:03:49,498 - INFO - Pickle file loaded successfully
2024-11-01 23:03:50,535 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:03:50,535 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:09:00,731 - INFO - Starting data download process
2024-11-01 23:09:00,731 - INFO - Starting data download process
2024-11-01 23:09:02,375 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:09:02,375 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:09:02,414 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:09:02,414 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:09:30,416 - INFO - Starting data loading process
2024-11-01 23:09:30,416 - INFO - Starting data loading process
2024-11-01 23:09:30,428 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:09:30,428 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:09:30,498 - INFO - Pickle file loaded successfully
2024-11-01 23:09:30,498 - INFO - Pickle file loaded successfully
2024-11-01 23:09:31,763 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:09:31,763 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:09:32,120 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:09:32,120 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:09:51,843 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:09:51,843 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:41,568 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:41,568 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:58,884 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:58,884 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:20:17,486 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:20:17,486 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:25:24,322 - INFO - Starting data download process
2024-11-01 23:25:24,322 - INFO - Starting data download process
2024-11-01 23:25:26,542 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:25:26,542 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:25:26,580 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:25:26,580 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:25:45,554 - INFO - Starting data loading process
2024-11-01 23:25:45,554 - INFO - Starting data loading process
2024-11-01 23:25:45,563 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:25:45,563 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:25:45,643 - INFO - Pickle file loaded successfully
2024-11-01 23:25:45,643 - INFO - Pickle file loaded successfully
2024-11-01 23:25:46,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:25:46,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:26:04,631 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:26:04,631 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:26:04,645 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:04,645 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:05,110 - INFO - Generated training data statistics.
2024-11-01 23:26:05,110 - INFO - Generated training data statistics.
2024-11-01 23:26:05,133 - INFO - Inferred schema from training data statistics.
2024-11-01 23:26:05,133 - INFO - Inferred schema from training data statistics.
2024-11-01 23:26:05,156 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:26:05,156 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:26:05,170 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:05,170 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:05,490 - INFO - Generated training data statistics.
2024-11-01 23:26:05,490 - INFO - Generated training data statistics.
2024-11-01 23:26:05,505 - INFO - Statistics visualization complete.
2024-11-01 23:26:05,505 - INFO - Statistics visualization complete.
2024-11-01 23:26:21,793 - INFO - Starting data processing...
2024-11-01 23:26:21,793 - INFO - Starting data processing...
2024-11-01 23:26:21,849 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:26:21,849 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:26:38,888 - INFO - Starting data processing
2024-11-01 23:26:38,888 - INFO - Starting data processing
2024-11-01 23:26:38,893 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:26:38,893 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:26:39,040 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:26:39,040 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:26:39,724 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:26:39,724 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:26:41,373 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:26:41,373 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:26:42,278 - INFO - No duplicate rows found.
2024-11-01 23:26:42,278 - INFO - No duplicate rows found.
2024-11-01 23:26:46,063 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:26:46,063 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:26:46,072 - INFO - age: 0.00%
2024-11-01 23:26:46,072 - INFO - age: 0.00%
2024-11-01 23:26:46,079 - INFO - job: 0.64%
2024-11-01 23:26:46,079 - INFO - job: 0.64%
2024-11-01 23:26:46,086 - INFO - marital: 0.00%
2024-11-01 23:26:46,086 - INFO - marital: 0.00%
2024-11-01 23:26:46,093 - INFO - education: 4.11%
2024-11-01 23:26:46,093 - INFO - education: 4.11%
2024-11-01 23:26:46,101 - INFO - default: 0.00%
2024-11-01 23:26:46,101 - INFO - default: 0.00%
2024-11-01 23:26:46,109 - INFO - balance: 0.00%
2024-11-01 23:26:46,109 - INFO - balance: 0.00%
2024-11-01 23:26:46,119 - INFO - housing: 0.00%
2024-11-01 23:26:46,119 - INFO - housing: 0.00%
2024-11-01 23:26:46,127 - INFO - loan: 0.00%
2024-11-01 23:26:46,127 - INFO - loan: 0.00%
2024-11-01 23:26:46,134 - INFO - contact: 28.80%
2024-11-01 23:26:46,134 - INFO - contact: 28.80%
2024-11-01 23:26:46,141 - INFO - day: 0.00%
2024-11-01 23:26:46,141 - INFO - day: 0.00%
2024-11-01 23:26:46,148 - INFO - month: 0.00%
2024-11-01 23:26:46,148 - INFO - month: 0.00%
2024-11-01 23:26:46,156 - INFO - duration: 0.00%
2024-11-01 23:26:46,156 - INFO - duration: 0.00%
2024-11-01 23:26:46,164 - INFO - campaign: 0.00%
2024-11-01 23:26:46,164 - INFO - campaign: 0.00%
2024-11-01 23:26:46,172 - INFO - pdays: 0.00%
2024-11-01 23:26:46,172 - INFO - pdays: 0.00%
2024-11-01 23:26:46,181 - INFO - previous: 0.00%
2024-11-01 23:26:46,181 - INFO - previous: 0.00%
2024-11-01 23:26:46,190 - INFO - poutcome: 81.75%
2024-11-01 23:26:46,190 - INFO - poutcome: 81.75%
2024-11-01 23:26:46,197 - INFO - y: 0.00%
2024-11-01 23:26:46,197 - INFO - y: 0.00%
2024-11-01 23:26:46,218 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:26:46,218 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:26:46,331 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:26:46,331 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:26:46,447 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:26:46,447 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:26:46,551 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:26:46,551 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:26:46,559 - INFO - Data processing completed successfully
2024-11-01 23:26:46,559 - INFO - Data processing completed successfully
2024-11-01 23:27:23,452 - INFO - Starting EDA process
2024-11-01 23:27:23,452 - INFO - Starting EDA process
2024-11-01 23:27:23,456 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:27:23,456 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:27:23,587 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:23,587 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:23,604 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:27:23,604 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:27:23,609 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:27:23,609 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:27:23,791 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:27:23,791 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:27:23,811 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:27:23,811 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:27:25,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:27:25,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:27:29,008 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:27:29,008 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:27:29,558 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:27:29,558 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:27:29,909 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:27:29,909 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:27:29,935 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:27:29,935 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:27:30,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:27:30,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:27:30,896 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:27:30,896 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:27:31,336 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:27:31,336 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:27:31,692 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:27:31,692 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:27:32,142 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:27:32,142 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:27:33,040 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:27:33,040 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:27:33,048 - INFO - EDA process completed successfully
2024-11-01 23:27:33,048 - INFO - EDA process completed successfully
2024-11-01 23:27:45,995 - INFO - Starting categorical encoding process
2024-11-01 23:27:45,995 - INFO - Starting categorical encoding process
2024-11-01 23:27:46,140 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:46,140 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:46,146 - INFO - Column datatypes:
2024-11-01 23:27:46,146 - INFO - Column datatypes:
2024-11-01 23:27:46,152 - INFO - age: float64
2024-11-01 23:27:46,152 - INFO - age: float64
2024-11-01 23:27:46,159 - INFO - job: string
2024-11-01 23:27:46,159 - INFO - job: string
2024-11-01 23:27:46,163 - INFO - marital: string
2024-11-01 23:27:46,163 - INFO - marital: string
2024-11-01 23:27:46,171 - INFO - education: string
2024-11-01 23:27:46,171 - INFO - education: string
2024-11-01 23:27:46,179 - INFO - default: string
2024-11-01 23:27:46,179 - INFO - default: string
2024-11-01 23:27:46,182 - INFO - balance: float64
2024-11-01 23:27:46,182 - INFO - balance: float64
2024-11-01 23:27:46,202 - INFO - housing: string
2024-11-01 23:27:46,202 - INFO - housing: string
2024-11-01 23:27:46,214 - INFO - loan: string
2024-11-01 23:27:46,214 - INFO - loan: string
2024-11-01 23:27:46,219 - INFO - contact: string
2024-11-01 23:27:46,219 - INFO - contact: string
2024-11-01 23:27:46,226 - INFO - day: float64
2024-11-01 23:27:46,226 - INFO - day: float64
2024-11-01 23:27:46,230 - INFO - month: string
2024-11-01 23:27:46,230 - INFO - month: string
2024-11-01 23:27:46,234 - INFO - duration: float64
2024-11-01 23:27:46,234 - INFO - duration: float64
2024-11-01 23:27:46,246 - INFO - campaign: float64
2024-11-01 23:27:46,246 - INFO - campaign: float64
2024-11-01 23:27:46,249 - INFO - pdays: float64
2024-11-01 23:27:46,249 - INFO - pdays: float64
2024-11-01 23:27:46,251 - INFO - previous: float64
2024-11-01 23:27:46,251 - INFO - previous: float64
2024-11-01 23:27:46,254 - INFO - y: string
2024-11-01 23:27:46,254 - INFO - y: string
2024-11-01 23:27:46,279 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:27:46,279 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:27:46,319 - INFO - Encoded column: job
2024-11-01 23:27:46,319 - INFO - Encoded column: job
2024-11-01 23:27:46,350 - INFO - Encoded column: marital
2024-11-01 23:27:46,350 - INFO - Encoded column: marital
2024-11-01 23:27:46,383 - INFO - Encoded column: education
2024-11-01 23:27:46,383 - INFO - Encoded column: education
2024-11-01 23:27:46,413 - INFO - Encoded column: default
2024-11-01 23:27:46,413 - INFO - Encoded column: default
2024-11-01 23:27:46,440 - INFO - Encoded column: housing
2024-11-01 23:27:46,440 - INFO - Encoded column: housing
2024-11-01 23:27:46,468 - INFO - Encoded column: loan
2024-11-01 23:27:46,468 - INFO - Encoded column: loan
2024-11-01 23:27:46,494 - INFO - Encoded column: contact
2024-11-01 23:27:46,494 - INFO - Encoded column: contact
2024-11-01 23:27:46,520 - INFO - Encoded column: month
2024-11-01 23:27:46,520 - INFO - Encoded column: month
2024-11-01 23:27:46,546 - INFO - Encoded column: y
2024-11-01 23:27:46,546 - INFO - Encoded column: y
2024-11-01 23:27:47,053 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:27:47,053 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:27:47,129 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:27:47,129 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:27:47,134 - INFO - Categorical encoding process completed successfully
2024-11-01 23:27:47,134 - INFO - Categorical encoding process completed successfully
2024-11-01 23:28:08,176 - INFO - Starting correlation analysis
2024-11-01 23:28:08,176 - INFO - Starting correlation analysis
2024-11-01 23:28:08,183 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:08,183 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:08,251 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:08,251 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:08,314 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:28:08,314 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:28:08,327 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:28:08,327 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:28:08,336 - INFO - No highly correlated pairs found.
2024-11-01 23:28:08,336 - INFO - No highly correlated pairs found.
2024-11-01 23:28:09,266 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:28:09,266 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:28:09,270 - INFO - Correlation analysis completed successfully
2024-11-01 23:28:09,270 - INFO - Correlation analysis completed successfully
2024-11-01 23:28:16,146 - INFO - Starting SMOTE analysis
2024-11-01 23:28:16,146 - INFO - Starting SMOTE analysis
2024-11-01 23:28:16,151 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:16,151 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:16,202 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:16,202 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:16,215 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:28:16,215 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:28:16,310 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:28:16,310 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:28:16,315 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:28:16,315 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:28:16,320 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:28:16,320 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:28:17,081 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:28:17,081 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:28:17,172 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:28:17,172 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:28:17,242 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:28:17,242 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:28:17,272 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:28:17,272 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:28:17,279 - INFO - SMOTE analysis completed successfully
2024-11-01 23:28:17,279 - INFO - SMOTE analysis completed successfully
2024-11-01 23:41:36,508 - INFO - Starting data download process
2024-11-01 23:41:36,508 - INFO - Starting data download process
2024-11-01 23:41:45,203 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:41:45,203 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:41:45,280 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:41:45,280 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:41:59,499 - INFO - Starting data loading process
2024-11-01 23:41:59,499 - INFO - Starting data loading process
2024-11-01 23:41:59,506 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:41:59,506 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:41:59,547 - INFO - Pickle file loaded successfully
2024-11-01 23:41:59,547 - INFO - Pickle file loaded successfully
2024-11-01 23:42:00,028 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:42:00,028 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:42:19,518 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:42:19,518 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:42:19,549 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:42:19,549 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:42:19,558 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:42:19,558 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:42:19,565 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:42:19,565 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:42:20,367 - INFO - Generated training data statistics.
2024-11-01 23:42:20,367 - INFO - Generated training data statistics.
2024-11-01 23:42:20,378 - INFO - Inferred schema from training data statistics.
2024-11-01 23:42:20,378 - INFO - Inferred schema from training data statistics.
2024-11-01 23:42:20,397 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:42:20,397 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:42:20,780 - INFO - Generated serving data statistics.
2024-11-01 23:42:20,780 - INFO - Generated serving data statistics.
2024-11-01 23:42:20,812 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:42:20,812 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:42:21,069 - INFO - Generated training data statistics.
2024-11-01 23:42:21,069 - INFO - Generated training data statistics.
2024-11-01 23:49:19,151 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:49:19,151 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:49:19,171 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:49:19,171 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:49:19,178 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:49:19,178 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:49:19,185 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:49:19,185 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:49:19,537 - INFO - Generated training data statistics.
2024-11-01 23:49:19,537 - INFO - Generated training data statistics.
2024-11-01 23:49:19,548 - INFO - Inferred schema from training data statistics.
2024-11-01 23:49:19,548 - INFO - Inferred schema from training data statistics.
2024-11-01 23:49:19,566 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:49:19,566 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:49:19,811 - INFO - Generated serving data statistics.
2024-11-01 23:49:19,811 - INFO - Generated serving data statistics.
2024-11-01 23:49:19,829 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:49:19,829 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:49:20,044 - INFO - Generated training data statistics.
2024-11-01 23:49:20,044 - INFO - Generated training data statistics.
2024-11-01 23:49:20,055 - INFO - Statistics visualization complete.
2024-11-01 23:49:20,055 - INFO - Statistics visualization complete.
2024-11-01 23:49:39,060 - INFO - Starting data processing...
2024-11-01 23:49:39,060 - INFO - Starting data processing...
2024-11-01 23:49:39,067 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:49:39,067 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:49:48,977 - INFO - Starting data processing
2024-11-01 23:49:48,977 - INFO - Starting data processing
2024-11-01 23:49:48,981 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:49:48,981 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:49:49,101 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:49:49,101 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:49:49,174 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:49:49,174 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:49:49,209 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:49:49,209 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:49:49,238 - INFO - No duplicate rows found.
2024-11-01 23:49:49,238 - INFO - No duplicate rows found.
2024-11-01 23:49:49,865 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:49:49,865 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:49:49,871 - INFO - age: 0.00%
2024-11-01 23:49:49,871 - INFO - age: 0.00%
2024-11-01 23:49:49,875 - INFO - job: 0.64%
2024-11-01 23:49:49,875 - INFO - job: 0.64%
2024-11-01 23:49:49,879 - INFO - marital: 0.00%
2024-11-01 23:49:49,879 - INFO - marital: 0.00%
2024-11-01 23:49:49,882 - INFO - education: 4.11%
2024-11-01 23:49:49,882 - INFO - education: 4.11%
2024-11-01 23:49:49,885 - INFO - default: 0.00%
2024-11-01 23:49:49,885 - INFO - default: 0.00%
2024-11-01 23:49:49,888 - INFO - balance: 0.00%
2024-11-01 23:49:49,888 - INFO - balance: 0.00%
2024-11-01 23:49:49,891 - INFO - housing: 0.00%
2024-11-01 23:49:49,891 - INFO - housing: 0.00%
2024-11-01 23:49:49,893 - INFO - loan: 0.00%
2024-11-01 23:49:49,893 - INFO - loan: 0.00%
2024-11-01 23:49:49,895 - INFO - contact: 28.80%
2024-11-01 23:49:49,895 - INFO - contact: 28.80%
2024-11-01 23:49:49,897 - INFO - day: 0.00%
2024-11-01 23:49:49,897 - INFO - day: 0.00%
2024-11-01 23:49:49,900 - INFO - month: 0.00%
2024-11-01 23:49:49,900 - INFO - month: 0.00%
2024-11-01 23:49:49,903 - INFO - duration: 0.00%
2024-11-01 23:49:49,903 - INFO - duration: 0.00%
2024-11-01 23:49:49,905 - INFO - campaign: 0.00%
2024-11-01 23:49:49,905 - INFO - campaign: 0.00%
2024-11-01 23:49:49,907 - INFO - pdays: 0.00%
2024-11-01 23:49:49,907 - INFO - pdays: 0.00%
2024-11-01 23:49:49,909 - INFO - previous: 0.00%
2024-11-01 23:49:49,909 - INFO - previous: 0.00%
2024-11-01 23:49:49,911 - INFO - poutcome: 81.75%
2024-11-01 23:49:49,911 - INFO - poutcome: 81.75%
2024-11-01 23:49:49,913 - INFO - y: 0.00%
2024-11-01 23:49:49,913 - INFO - y: 0.00%
2024-11-01 23:49:49,921 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:49:49,921 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:49:49,977 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:49:49,977 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:49:50,028 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:49:50,028 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:49:50,077 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:49:50,077 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:49:50,082 - INFO - Data processing completed successfully
2024-11-01 23:49:50,082 - INFO - Data processing completed successfully
2024-11-01 23:50:05,590 - INFO - Starting EDA process
2024-11-01 23:50:05,590 - INFO - Starting EDA process
2024-11-01 23:50:05,595 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:50:05,595 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:50:05,708 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:05,708 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:05,723 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:50:05,723 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:50:05,728 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:50:05,728 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:50:05,864 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:50:05,864 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:50:05,874 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:50:05,874 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:50:06,053 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:50:06,053 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:50:06,193 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:50:06,193 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:50:06,327 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:50:06,327 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:50:06,450 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:50:06,450 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:50:06,458 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:50:06,458 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:50:06,660 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:50:06,660 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:50:06,822 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:50:06,822 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:50:06,987 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:50:06,987 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:50:07,124 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:50:07,124 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:50:07,273 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:50:07,273 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:50:07,664 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:07,664 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:07,669 - INFO - EDA process completed successfully
2024-11-01 23:50:07,669 - INFO - EDA process completed successfully
2024-11-01 23:50:19,505 - INFO - Starting categorical encoding process
2024-11-01 23:50:19,505 - INFO - Starting categorical encoding process
2024-11-01 23:50:21,350 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:21,350 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:21,392 - INFO - Column datatypes:
2024-11-01 23:50:21,392 - INFO - Column datatypes:
2024-11-01 23:50:21,445 - INFO - age: float64
2024-11-01 23:50:21,445 - INFO - age: float64
2024-11-01 23:50:21,491 - INFO - job: string
2024-11-01 23:50:21,491 - INFO - job: string
2024-11-01 23:50:21,526 - INFO - marital: string
2024-11-01 23:50:21,526 - INFO - marital: string
2024-11-01 23:50:21,573 - INFO - education: string
2024-11-01 23:50:21,573 - INFO - education: string
2024-11-01 23:50:21,605 - INFO - default: string
2024-11-01 23:50:21,605 - INFO - default: string
2024-11-01 23:50:21,638 - INFO - balance: float64
2024-11-01 23:50:21,638 - INFO - balance: float64
2024-11-01 23:50:21,692 - INFO - housing: string
2024-11-01 23:50:21,692 - INFO - housing: string
2024-11-01 23:50:21,727 - INFO - loan: string
2024-11-01 23:50:21,727 - INFO - loan: string
2024-11-01 23:50:21,759 - INFO - contact: string
2024-11-01 23:50:21,759 - INFO - contact: string
2024-11-01 23:50:21,796 - INFO - day: float64
2024-11-01 23:50:21,796 - INFO - day: float64
2024-11-01 23:50:21,829 - INFO - month: string
2024-11-01 23:50:21,829 - INFO - month: string
2024-11-01 23:50:21,863 - INFO - duration: float64
2024-11-01 23:50:21,863 - INFO - duration: float64
2024-11-01 23:50:21,897 - INFO - campaign: float64
2024-11-01 23:50:21,897 - INFO - campaign: float64
2024-11-01 23:50:21,931 - INFO - pdays: float64
2024-11-01 23:50:21,931 - INFO - pdays: float64
2024-11-01 23:50:21,974 - INFO - previous: float64
2024-11-01 23:50:21,974 - INFO - previous: float64
2024-11-01 23:50:22,020 - INFO - y: string
2024-11-01 23:50:22,020 - INFO - y: string
2024-11-01 23:50:22,208 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:50:22,208 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:50:22,497 - INFO - Encoded column: job
2024-11-01 23:50:22,497 - INFO - Encoded column: job
2024-11-01 23:50:22,579 - INFO - Encoded column: marital
2024-11-01 23:50:22,579 - INFO - Encoded column: marital
2024-11-01 23:50:22,655 - INFO - Encoded column: education
2024-11-01 23:50:22,655 - INFO - Encoded column: education
2024-11-01 23:50:22,730 - INFO - Encoded column: default
2024-11-01 23:50:22,730 - INFO - Encoded column: default
2024-11-01 23:50:22,857 - INFO - Encoded column: housing
2024-11-01 23:50:22,857 - INFO - Encoded column: housing
2024-11-01 23:50:22,931 - INFO - Encoded column: loan
2024-11-01 23:50:22,931 - INFO - Encoded column: loan
2024-11-01 23:50:22,988 - INFO - Encoded column: contact
2024-11-01 23:50:22,988 - INFO - Encoded column: contact
2024-11-01 23:50:23,048 - INFO - Encoded column: month
2024-11-01 23:50:23,048 - INFO - Encoded column: month
2024-11-01 23:50:23,104 - INFO - Encoded column: y
2024-11-01 23:50:23,104 - INFO - Encoded column: y
2024-11-01 23:50:23,985 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:50:23,985 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:50:24,173 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:24,173 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:24,182 - INFO - Categorical encoding process completed successfully
2024-11-01 23:50:24,182 - INFO - Categorical encoding process completed successfully
2024-11-01 23:50:39,063 - INFO - Starting correlation analysis
2024-11-01 23:50:39,063 - INFO - Starting correlation analysis
2024-11-01 23:50:39,068 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:39,068 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:39,105 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:39,105 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:39,159 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:50:39,159 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:50:39,164 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:50:39,164 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:50:39,172 - INFO - No highly correlated pairs found.
2024-11-01 23:50:39,172 - INFO - No highly correlated pairs found.
2024-11-01 23:50:40,109 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:40,109 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:40,114 - INFO - Correlation analysis completed successfully
2024-11-01 23:50:40,114 - INFO - Correlation analysis completed successfully
2024-11-01 23:50:47,981 - INFO - Starting SMOTE analysis
2024-11-01 23:50:47,981 - INFO - Starting SMOTE analysis
2024-11-01 23:50:47,984 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:47,984 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:48,025 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:48,025 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:48,037 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:50:48,037 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:50:48,160 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:50:48,160 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:50:48,163 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:50:48,163 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:50:48,168 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:50:48,168 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:50:48,912 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:50:48,912 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:50:48,991 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:50:48,991 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:50:49,057 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:50:49,057 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:50:49,077 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:50:49,077 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:50:49,080 - INFO - SMOTE analysis completed successfully
2024-11-01 23:50:49,080 - INFO - SMOTE analysis completed successfully
2024-11-01 23:51:40,099 - INFO - Starting data download process
2024-11-01 23:51:40,099 - INFO - Starting data download process
2024-11-01 23:51:43,193 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:51:43,193 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:51:43,235 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:51:43,235 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:51:51,010 - INFO - Starting data loading process
2024-11-01 23:51:51,010 - INFO - Starting data loading process
2024-11-01 23:51:51,013 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:51:51,013 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:51:51,041 - INFO - Pickle file loaded successfully
2024-11-01 23:51:51,041 - INFO - Pickle file loaded successfully
2024-11-01 23:51:56,651 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:51:56,651 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:52:11,493 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:52:11,493 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:52:11,504 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:52:11,504 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:52:11,509 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:52:11,509 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:52:11,514 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:52:11,514 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:52:11,684 - INFO - Generated training data statistics.
2024-11-01 23:52:11,684 - INFO - Generated training data statistics.
2024-11-01 23:52:11,690 - INFO - Inferred schema from training data statistics.
2024-11-01 23:52:11,690 - INFO - Inferred schema from training data statistics.
2024-11-01 23:52:11,699 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:52:11,699 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:52:11,797 - INFO - Generated serving data statistics.
2024-11-01 23:52:11,797 - INFO - Generated serving data statistics.
2024-11-01 23:52:11,807 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:52:11,807 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:52:11,904 - INFO - Generated training data statistics.
2024-11-01 23:52:11,904 - INFO - Generated training data statistics.
2024-11-01 23:52:11,911 - INFO - Statistics visualization complete.
2024-11-01 23:52:11,911 - INFO - Statistics visualization complete.
2024-11-01 23:52:38,934 - INFO - Starting data processing...
2024-11-01 23:52:38,934 - INFO - Starting data processing...
2024-11-01 23:52:38,944 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:52:38,944 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:52:54,088 - INFO - Starting data processing
2024-11-01 23:52:54,088 - INFO - Starting data processing
2024-11-01 23:52:54,094 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:52:54,094 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:52:54,241 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:52:54,241 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:52:54,327 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:52:54,327 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:52:54,364 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:52:54,364 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:52:54,394 - INFO - No duplicate rows found.
2024-11-01 23:52:54,394 - INFO - No duplicate rows found.
2024-11-01 23:52:55,131 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:52:55,131 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:52:55,136 - INFO - age: 0.00%
2024-11-01 23:52:55,136 - INFO - age: 0.00%
2024-11-01 23:52:55,141 - INFO - job: 0.64%
2024-11-01 23:52:55,141 - INFO - job: 0.64%
2024-11-01 23:52:55,144 - INFO - marital: 0.00%
2024-11-01 23:52:55,144 - INFO - marital: 0.00%
2024-11-01 23:52:55,146 - INFO - education: 4.11%
2024-11-01 23:52:55,146 - INFO - education: 4.11%
2024-11-01 23:52:55,150 - INFO - default: 0.00%
2024-11-01 23:52:55,150 - INFO - default: 0.00%
2024-11-01 23:52:55,153 - INFO - balance: 0.00%
2024-11-01 23:52:55,153 - INFO - balance: 0.00%
2024-11-01 23:52:55,157 - INFO - housing: 0.00%
2024-11-01 23:52:55,157 - INFO - housing: 0.00%
2024-11-01 23:52:55,160 - INFO - loan: 0.00%
2024-11-01 23:52:55,160 - INFO - loan: 0.00%
2024-11-01 23:52:55,164 - INFO - contact: 28.80%
2024-11-01 23:52:55,164 - INFO - contact: 28.80%
2024-11-01 23:52:55,167 - INFO - day: 0.00%
2024-11-01 23:52:55,167 - INFO - day: 0.00%
2024-11-01 23:52:55,170 - INFO - month: 0.00%
2024-11-01 23:52:55,170 - INFO - month: 0.00%
2024-11-01 23:52:55,175 - INFO - duration: 0.00%
2024-11-01 23:52:55,175 - INFO - duration: 0.00%
2024-11-01 23:52:55,178 - INFO - campaign: 0.00%
2024-11-01 23:52:55,178 - INFO - campaign: 0.00%
2024-11-01 23:52:55,182 - INFO - pdays: 0.00%
2024-11-01 23:52:55,182 - INFO - pdays: 0.00%
2024-11-01 23:52:55,186 - INFO - previous: 0.00%
2024-11-01 23:52:55,186 - INFO - previous: 0.00%
2024-11-01 23:52:55,189 - INFO - poutcome: 81.75%
2024-11-01 23:52:55,189 - INFO - poutcome: 81.75%
2024-11-01 23:52:55,193 - INFO - y: 0.00%
2024-11-01 23:52:55,193 - INFO - y: 0.00%
2024-11-01 23:52:55,202 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:52:55,202 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:52:55,266 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:52:55,266 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:52:55,317 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:52:55,317 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:52:55,374 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:52:55,374 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:52:55,378 - INFO - Data processing completed successfully
2024-11-01 23:52:55,378 - INFO - Data processing completed successfully
2024-11-01 23:53:13,667 - INFO - Starting EDA process
2024-11-01 23:53:13,667 - INFO - Starting EDA process
2024-11-01 23:53:13,671 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:53:13,671 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:53:13,815 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:13,815 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:13,832 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:53:13,832 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:53:13,835 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:53:13,835 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:53:13,999 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:53:13,999 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:53:14,011 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:53:14,011 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:53:15,058 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:53:15,058 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:53:17,892 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:53:17,892 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:53:19,405 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:53:19,405 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:53:19,851 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:53:19,851 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:53:19,876 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:53:19,876 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:53:20,443 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:53:20,443 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:53:20,927 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:53:20,927 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:53:21,464 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:53:21,464 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:53:21,904 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:53:21,904 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:53:22,352 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:53:22,352 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:53:23,577 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:23,577 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:23,584 - INFO - EDA process completed successfully
2024-11-01 23:53:23,584 - INFO - EDA process completed successfully
2024-11-01 23:53:37,200 - INFO - Starting categorical encoding process
2024-11-01 23:53:37,200 - INFO - Starting categorical encoding process
2024-11-01 23:53:37,329 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:37,329 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:37,335 - INFO - Column datatypes:
2024-11-01 23:53:37,335 - INFO - Column datatypes:
2024-11-01 23:53:37,341 - INFO - age: float64
2024-11-01 23:53:37,341 - INFO - age: float64
2024-11-01 23:53:37,345 - INFO - job: string
2024-11-01 23:53:37,345 - INFO - job: string
2024-11-01 23:53:37,348 - INFO - marital: string
2024-11-01 23:53:37,348 - INFO - marital: string
2024-11-01 23:53:37,352 - INFO - education: string
2024-11-01 23:53:37,352 - INFO - education: string
2024-11-01 23:53:37,355 - INFO - default: string
2024-11-01 23:53:37,355 - INFO - default: string
2024-11-01 23:53:37,358 - INFO - balance: float64
2024-11-01 23:53:37,358 - INFO - balance: float64
2024-11-01 23:53:37,361 - INFO - housing: string
2024-11-01 23:53:37,361 - INFO - housing: string
2024-11-01 23:53:37,363 - INFO - loan: string
2024-11-01 23:53:37,363 - INFO - loan: string
2024-11-01 23:53:37,366 - INFO - contact: string
2024-11-01 23:53:37,366 - INFO - contact: string
2024-11-01 23:53:37,369 - INFO - day: float64
2024-11-01 23:53:37,369 - INFO - day: float64
2024-11-01 23:53:37,372 - INFO - month: string
2024-11-01 23:53:37,372 - INFO - month: string
2024-11-01 23:53:37,376 - INFO - duration: float64
2024-11-01 23:53:37,376 - INFO - duration: float64
2024-11-01 23:53:37,379 - INFO - campaign: float64
2024-11-01 23:53:37,379 - INFO - campaign: float64
2024-11-01 23:53:37,381 - INFO - pdays: float64
2024-11-01 23:53:37,381 - INFO - pdays: float64
2024-11-01 23:53:37,384 - INFO - previous: float64
2024-11-01 23:53:37,384 - INFO - previous: float64
2024-11-01 23:53:37,388 - INFO - y: string
2024-11-01 23:53:37,388 - INFO - y: string
2024-11-01 23:53:37,406 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:53:37,406 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:53:37,435 - INFO - Encoded column: job
2024-11-01 23:53:37,435 - INFO - Encoded column: job
2024-11-01 23:53:37,462 - INFO - Encoded column: marital
2024-11-01 23:53:37,462 - INFO - Encoded column: marital
2024-11-01 23:53:37,488 - INFO - Encoded column: education
2024-11-01 23:53:37,488 - INFO - Encoded column: education
2024-11-01 23:53:37,513 - INFO - Encoded column: default
2024-11-01 23:53:37,513 - INFO - Encoded column: default
2024-11-01 23:53:37,540 - INFO - Encoded column: housing
2024-11-01 23:53:37,540 - INFO - Encoded column: housing
2024-11-01 23:53:37,563 - INFO - Encoded column: loan
2024-11-01 23:53:37,563 - INFO - Encoded column: loan
2024-11-01 23:53:37,586 - INFO - Encoded column: contact
2024-11-01 23:53:37,586 - INFO - Encoded column: contact
2024-11-01 23:53:37,610 - INFO - Encoded column: month
2024-11-01 23:53:37,610 - INFO - Encoded column: month
2024-11-01 23:53:37,633 - INFO - Encoded column: y
2024-11-01 23:53:37,633 - INFO - Encoded column: y
2024-11-01 23:53:38,011 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:53:38,011 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:53:38,063 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:38,063 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:38,067 - INFO - Categorical encoding process completed successfully
2024-11-01 23:53:38,067 - INFO - Categorical encoding process completed successfully
2024-11-01 23:53:45,448 - INFO - Starting correlation analysis
2024-11-01 23:53:45,448 - INFO - Starting correlation analysis
2024-11-01 23:53:45,454 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:45,454 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:45,507 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:53:45,507 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:53:45,586 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:53:45,586 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:53:45,595 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:53:45,595 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:53:45,607 - INFO - No highly correlated pairs found.
2024-11-01 23:53:45,607 - INFO - No highly correlated pairs found.
2024-11-01 23:53:51,990 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:51,990 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:51,997 - INFO - Correlation analysis completed successfully
2024-11-01 23:53:51,997 - INFO - Correlation analysis completed successfully
2024-11-01 23:54:07,139 - INFO - Starting SMOTE analysis
2024-11-01 23:54:07,139 - INFO - Starting SMOTE analysis
2024-11-01 23:54:07,147 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:54:07,147 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:54:07,257 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:54:07,257 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:54:07,310 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:54:07,310 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:54:07,551 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:54:07,551 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:54:07,559 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:54:07,559 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:54:07,565 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:54:07,565 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:54:08,251 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:54:08,251 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:54:08,336 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:54:08,336 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:54:08,397 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:54:08,397 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:54:08,421 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:54:08,421 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:54:08,426 - INFO - SMOTE analysis completed successfully
2024-11-01 23:54:08,426 - INFO - SMOTE analysis completed successfully
