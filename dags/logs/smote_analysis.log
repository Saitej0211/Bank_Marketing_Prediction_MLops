2024-10-28 23:10:07,592 - INFO - Starting data download process
2024-10-28 23:10:07,596 - INFO - Starting data download process
2024-10-28 23:10:09,014 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-10-28 23:10:09,072 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-10-28 23:10:09,185 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-10-28 23:10:09,249 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-10-28 23:10:18,254 - INFO - Starting data loading process
2024-10-28 23:10:18,260 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-10-28 23:10:18,279 - INFO - Starting data loading process
2024-10-28 23:10:18,291 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-10-28 23:10:18,326 - INFO - Pickle file loaded successfully
2024-10-28 23:10:18,337 - INFO - Pickle file loaded successfully
2024-10-28 23:10:19,198 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-10-28 23:10:19,201 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-10-28 23:10:27,827 - INFO - Starting data processing
2024-10-28 23:10:27,827 - INFO - Starting data processing
2024-10-28 23:10:27,831 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-10-28 23:10:27,831 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-10-28 23:10:27,967 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-10-28 23:10:27,970 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-10-28 23:10:28,079 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-10-28 23:10:28,080 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-10-28 23:10:28,122 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-10-28 23:10:28,136 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-10-28 23:10:28,165 - INFO - No duplicate rows found.
2024-10-28 23:10:28,175 - INFO - No duplicate rows found.
2024-10-28 23:10:29,061 - INFO - Percentage of null or unknown values in each column:
2024-10-28 23:10:29,066 - INFO - age: 0.00%
2024-10-28 23:10:29,070 - INFO - job: 0.64%
2024-10-28 23:10:29,073 - INFO - marital: 0.00%
2024-10-28 23:10:29,075 - INFO - education: 4.11%
2024-10-28 23:10:29,078 - INFO - default: 0.00%
2024-10-28 23:10:29,081 - INFO - balance: 0.00%
2024-10-28 23:10:29,084 - INFO - housing: 0.00%
2024-10-28 23:10:29,087 - INFO - loan: 0.00%
2024-10-28 23:10:29,089 - INFO - Percentage of null or unknown values in each column:
2024-10-28 23:10:29,090 - INFO - contact: 28.80%
2024-10-28 23:10:29,092 - INFO - age: 0.00%
2024-10-28 23:10:29,093 - INFO - day: 0.00%
2024-10-28 23:10:29,096 - INFO - job: 0.64%
2024-10-28 23:10:29,096 - INFO - month: 0.00%
2024-10-28 23:10:29,099 - INFO - marital: 0.00%
2024-10-28 23:10:29,099 - INFO - duration: 0.00%
2024-10-28 23:10:29,101 - INFO - education: 4.11%
2024-10-28 23:10:29,102 - INFO - campaign: 0.00%
2024-10-28 23:10:29,104 - INFO - default: 0.00%
2024-10-28 23:10:29,104 - INFO - pdays: 0.00%
2024-10-28 23:10:29,106 - INFO - balance: 0.00%
2024-10-28 23:10:29,107 - INFO - previous: 0.00%
2024-10-28 23:10:29,109 - INFO - housing: 0.00%
2024-10-28 23:10:29,110 - INFO - poutcome: 81.75%
2024-10-28 23:10:29,112 - INFO - loan: 0.00%
2024-10-28 23:10:29,112 - INFO - y: 0.00%
2024-10-28 23:10:29,114 - INFO - contact: 28.80%
2024-10-28 23:10:29,116 - INFO - day: 0.00%
2024-10-28 23:10:29,119 - INFO - month: 0.00%
2024-10-28 23:10:29,121 - INFO - duration: 0.00%
2024-10-28 23:10:29,121 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-10-28 23:10:29,123 - INFO - campaign: 0.00%
2024-10-28 23:10:29,125 - INFO - pdays: 0.00%
2024-10-28 23:10:29,127 - INFO - previous: 0.00%
2024-10-28 23:10:29,129 - INFO - poutcome: 81.75%
2024-10-28 23:10:29,131 - INFO - y: 0.00%
2024-10-28 23:10:29,142 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-10-28 23:10:29,181 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-10-28 23:10:29,201 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-10-28 23:10:29,269 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-10-28 23:10:29,305 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-10-28 23:10:29,349 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-10-28 23:10:29,353 - INFO - Data processing completed successfully
2024-10-28 23:10:29,383 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-10-28 23:10:29,388 - INFO - Data processing completed successfully
2024-10-28 23:10:47,365 - INFO - Starting EDA process
2024-10-28 23:10:47,371 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-10-28 23:10:47,502 - INFO - Starting EDA process
2024-10-28 23:10:47,508 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-10-28 23:10:47,614 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-10-28 23:10:47,640 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-10-28 23:10:47,647 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-10-28 23:10:47,775 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-10-28 23:10:47,806 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-10-28 23:10:47,811 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-10-28 23:10:47,910 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-10-28 23:10:47,923 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-10-28 23:10:48,059 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-10-28 23:10:48,078 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-10-28 23:10:48,238 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-10-28 23:10:48,269 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-10-28 23:10:48,421 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-10-28 23:10:48,438 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-10-28 23:10:48,634 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-10-28 23:10:48,637 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-10-28 23:10:48,812 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-10-28 23:10:48,813 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-10-28 23:10:48,823 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-10-28 23:10:48,824 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-10-28 23:10:49,069 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-10-28 23:10:49,070 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-10-28 23:10:49,443 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-10-28 23:10:49,444 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-10-28 23:10:49,941 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-10-28 23:10:49,942 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-10-28 23:10:50,185 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-10-28 23:10:50,189 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-10-28 23:10:50,393 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-10-28 23:10:50,397 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-10-28 23:10:50,953 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-10-28 23:10:50,959 - INFO - EDA process completed successfully
2024-10-28 23:10:51,045 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-10-28 23:10:51,051 - INFO - EDA process completed successfully
2024-10-28 23:11:00,129 - INFO - Starting categorical encoding process
2024-10-28 23:11:00,138 - INFO - Starting categorical encoding process
2024-10-28 23:11:00,323 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-10-28 23:11:00,323 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-10-28 23:11:00,328 - INFO - Column datatypes:
2024-10-28 23:11:00,328 - INFO - Column datatypes:
2024-10-28 23:11:00,333 - INFO - age: float64
2024-10-28 23:11:00,333 - INFO - age: float64
2024-10-28 23:11:00,336 - INFO - job: string
2024-10-28 23:11:00,336 - INFO - job: string
2024-10-28 23:11:00,339 - INFO - marital: string
2024-10-28 23:11:00,340 - INFO - marital: string
2024-10-28 23:11:00,342 - INFO - education: string
2024-10-28 23:11:00,342 - INFO - education: string
2024-10-28 23:11:00,345 - INFO - default: string
2024-10-28 23:11:00,346 - INFO - default: string
2024-10-28 23:11:00,348 - INFO - balance: float64
2024-10-28 23:11:00,348 - INFO - balance: float64
2024-10-28 23:11:00,351 - INFO - housing: string
2024-10-28 23:11:00,351 - INFO - housing: string
2024-10-28 23:11:00,353 - INFO - loan: string
2024-10-28 23:11:00,354 - INFO - loan: string
2024-10-28 23:11:00,356 - INFO - contact: string
2024-10-28 23:11:00,357 - INFO - contact: string
2024-10-28 23:11:00,359 - INFO - day: float64
2024-10-28 23:11:00,359 - INFO - day: float64
2024-10-28 23:11:00,362 - INFO - month: string
2024-10-28 23:11:00,362 - INFO - month: string
2024-10-28 23:11:00,364 - INFO - duration: float64
2024-10-28 23:11:00,365 - INFO - duration: float64
2024-10-28 23:11:00,367 - INFO - campaign: float64
2024-10-28 23:11:00,367 - INFO - campaign: float64
2024-10-28 23:11:00,369 - INFO - pdays: float64
2024-10-28 23:11:00,369 - INFO - pdays: float64
2024-10-28 23:11:00,372 - INFO - previous: float64
2024-10-28 23:11:00,372 - INFO - previous: float64
2024-10-28 23:11:00,375 - INFO - y: string
2024-10-28 23:11:00,375 - INFO - y: string
2024-10-28 23:11:00,397 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-10-28 23:11:00,397 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-10-28 23:11:00,431 - INFO - Encoded column: job
2024-10-28 23:11:00,431 - INFO - Encoded column: job
2024-10-28 23:11:00,459 - INFO - Encoded column: marital
2024-10-28 23:11:00,459 - INFO - Encoded column: marital
2024-10-28 23:11:00,496 - INFO - Encoded column: education
2024-10-28 23:11:00,496 - INFO - Encoded column: education
2024-10-28 23:11:00,520 - INFO - Encoded column: default
2024-10-28 23:11:00,520 - INFO - Encoded column: default
2024-10-28 23:11:00,543 - INFO - Encoded column: housing
2024-10-28 23:11:00,543 - INFO - Encoded column: housing
2024-10-28 23:11:00,568 - INFO - Encoded column: loan
2024-10-28 23:11:00,568 - INFO - Encoded column: loan
2024-10-28 23:11:00,590 - INFO - Encoded column: contact
2024-10-28 23:11:00,591 - INFO - Encoded column: contact
2024-10-28 23:11:00,612 - INFO - Encoded column: month
2024-10-28 23:11:00,613 - INFO - Encoded column: month
2024-10-28 23:11:00,634 - INFO - Encoded column: y
2024-10-28 23:11:00,634 - INFO - Encoded column: y
2024-10-28 23:11:01,042 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-10-28 23:11:01,048 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-10-28 23:11:01,122 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:01,123 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:01,125 - INFO - Categorical encoding process completed successfully
2024-10-28 23:11:01,126 - INFO - Categorical encoding process completed successfully
2024-10-28 23:11:10,515 - INFO - Starting correlation analysis
2024-10-28 23:11:10,527 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:10,648 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-10-28 23:11:10,655 - INFO - Starting correlation analysis
2024-10-28 23:11:10,668 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:10,819 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-10-28 23:11:10,836 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-10-28 23:11:10,844 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-10-28 23:11:10,865 - INFO - No highly correlated pairs found.
2024-10-28 23:11:10,897 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-10-28 23:11:10,908 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-10-28 23:11:10,917 - INFO - No highly correlated pairs found.
2024-10-28 23:11:12,380 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-10-28 23:11:12,384 - INFO - Correlation analysis completed successfully
2024-10-28 23:11:12,427 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-10-28 23:11:12,436 - INFO - Correlation analysis completed successfully
2024-10-28 23:11:22,438 - INFO - Starting SMOTE analysis
2024-10-28 23:11:22,443 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:22,451 - INFO - Starting SMOTE analysis
2024-10-28 23:11:22,456 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-10-28 23:11:22,579 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-10-28 23:11:22,588 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-10-28 23:11:22,687 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-10-28 23:11:22,689 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-10-28 23:11:22,811 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-10-28 23:11:22,815 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-10-28 23:11:22,818 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-10-28 23:11:22,820 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-10-28 23:11:22,821 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-10-28 23:11:22,826 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-10-28 23:11:23,612 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-10-28 23:11:23,615 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-10-28 23:11:23,802 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-10-28 23:11:23,817 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-10-28 23:11:23,928 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-10-28 23:11:23,932 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-10-28 23:11:23,955 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-10-28 23:11:23,957 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-10-28 23:11:23,959 - INFO - SMOTE analysis completed successfully
2024-10-28 23:11:23,960 - INFO - SMOTE analysis completed successfully
2024-11-01 20:50:25,991 - INFO - Starting data download process
2024-11-01 20:50:28,863 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 20:50:28,942 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 20:50:51,127 - INFO - Starting data loading process
2024-11-01 20:50:51,138 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 20:50:51,222 - INFO - Pickle file loaded successfully
2024-11-01 20:50:52,478 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:30:24,312 - INFO - Starting data download process
2024-11-01 21:30:28,123 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:30:28,250 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:30:47,321 - INFO - Starting data loading process
2024-11-01 21:30:47,328 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:30:47,425 - INFO - Pickle file loaded successfully
2024-11-01 21:30:48,630 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:31:03,423 - INFO - Data loaded from /opt/airflow/data/processed/raw_data.pkl. Type: <class 'bytes'>
2024-11-01 21:37:04,591 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:37:14,727 - INFO - Starting data download process
2024-11-01 21:37:19,233 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:37:19,279 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:37:39,299 - INFO - Starting data loading process
2024-11-01 21:37:39,307 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:37:39,372 - INFO - Pickle file loaded successfully
2024-11-01 21:37:40,444 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:38:02,260 - ERROR - Error loading data from /opt/airflow/data/processed/raw_data.csv: unpickling stack underflow
2024-11-01 21:50:48,011 - INFO - Starting data download process
2024-11-01 21:50:54,394 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 21:50:54,448 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 21:51:03,211 - INFO - Starting data loading process
2024-11-01 21:51:03,218 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 21:51:03,277 - INFO - Pickle file loaded successfully
2024-11-01 21:51:03,906 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:56:30,244 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 21:56:30,253 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,567 - INFO - Generated training data statistics.
2024-11-01 21:56:30,591 - INFO - Inferred schema from training data statistics.
2024-11-01 21:56:30,700 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 21:56:30,711 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 21:56:30,960 - INFO - Generated training data statistics.
2024-11-01 21:56:30,966 - INFO - Statistics visualization complete.
2024-11-01 21:56:39,073 - INFO - Starting data processing...
2024-11-01 21:56:39,080 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 21:56:59,095 - INFO - Starting data processing
2024-11-01 21:56:59,103 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 21:56:59,388 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 21:56:59,672 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 21:56:59,784 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 21:56:59,868 - INFO - No duplicate rows found.
2024-11-01 21:57:02,005 - INFO - Percentage of null or unknown values in each column:
2024-11-01 21:57:02,014 - INFO - age: 0.00%
2024-11-01 21:57:02,020 - INFO - job: 0.64%
2024-11-01 21:57:02,027 - INFO - marital: 0.00%
2024-11-01 21:57:02,033 - INFO - education: 4.11%
2024-11-01 21:57:02,039 - INFO - default: 0.00%
2024-11-01 21:57:02,047 - INFO - balance: 0.00%
2024-11-01 21:57:02,053 - INFO - housing: 0.00%
2024-11-01 21:57:02,060 - INFO - loan: 0.00%
2024-11-01 21:57:02,068 - INFO - contact: 28.80%
2024-11-01 21:57:02,075 - INFO - day: 0.00%
2024-11-01 21:57:02,082 - INFO - month: 0.00%
2024-11-01 21:57:02,088 - INFO - duration: 0.00%
2024-11-01 21:57:02,098 - INFO - campaign: 0.00%
2024-11-01 21:57:02,105 - INFO - pdays: 0.00%
2024-11-01 21:57:02,113 - INFO - previous: 0.00%
2024-11-01 21:57:02,119 - INFO - poutcome: 81.75%
2024-11-01 21:57:02,127 - INFO - y: 0.00%
2024-11-01 21:57:02,149 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 21:57:02,287 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 21:57:02,416 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 21:57:02,522 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 21:57:02,534 - INFO - Data processing completed successfully
2024-11-01 21:57:33,027 - INFO - Starting EDA process
2024-11-01 21:57:33,031 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 21:57:33,146 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:33,161 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 21:57:33,165 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 21:57:33,359 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 21:57:33,370 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 21:57:33,547 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 21:57:33,705 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 21:57:33,855 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 21:57:34,015 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 21:57:34,027 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 21:57:34,252 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 21:57:34,441 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 21:57:34,615 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 21:57:34,769 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 21:57:34,966 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 21:57:40,351 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:57:40,363 - INFO - EDA process completed successfully
2024-11-01 21:57:55,869 - INFO - Starting categorical encoding process
2024-11-01 21:57:56,193 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 21:57:56,202 - INFO - Column datatypes:
2024-11-01 21:57:56,214 - INFO - age: float64
2024-11-01 21:57:56,231 - INFO - job: string
2024-11-01 21:57:56,240 - INFO - marital: string
2024-11-01 21:57:56,247 - INFO - education: string
2024-11-01 21:57:56,253 - INFO - default: string
2024-11-01 21:57:56,260 - INFO - balance: float64
2024-11-01 21:57:56,266 - INFO - housing: string
2024-11-01 21:57:56,273 - INFO - loan: string
2024-11-01 21:57:56,281 - INFO - contact: string
2024-11-01 21:57:56,288 - INFO - day: float64
2024-11-01 21:57:56,295 - INFO - month: string
2024-11-01 21:57:56,303 - INFO - duration: float64
2024-11-01 21:57:56,311 - INFO - campaign: float64
2024-11-01 21:57:56,319 - INFO - pdays: float64
2024-11-01 21:57:56,328 - INFO - previous: float64
2024-11-01 21:57:56,338 - INFO - y: string
2024-11-01 21:57:56,382 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 21:57:56,445 - INFO - Encoded column: job
2024-11-01 21:57:56,484 - INFO - Encoded column: marital
2024-11-01 21:57:56,524 - INFO - Encoded column: education
2024-11-01 21:57:56,551 - INFO - Encoded column: default
2024-11-01 21:57:56,581 - INFO - Encoded column: housing
2024-11-01 21:57:56,606 - INFO - Encoded column: loan
2024-11-01 21:57:56,629 - INFO - Encoded column: contact
2024-11-01 21:57:56,660 - INFO - Encoded column: month
2024-11-01 21:57:56,686 - INFO - Encoded column: y
2024-11-01 21:57:57,140 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 21:57:57,187 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:57:57,191 - INFO - Categorical encoding process completed successfully
2024-11-01 21:58:17,230 - INFO - Starting correlation analysis
2024-11-01 21:58:17,240 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:17,349 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:17,444 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 21:58:17,460 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 21:58:17,477 - INFO - No highly correlated pairs found.
2024-11-01 21:58:19,067 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 21:58:19,072 - INFO - Correlation analysis completed successfully
2024-11-01 21:58:28,027 - INFO - Starting SMOTE analysis
2024-11-01 21:58:28,030 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 21:58:28,075 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 21:58:28,089 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 21:58:28,208 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 21:58:28,212 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 21:58:28,218 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 21:58:29,743 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 21:58:30,871 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 21:58:31,446 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 21:58:31,702 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 21:58:31,760 - INFO - SMOTE analysis completed successfully
2024-11-01 22:32:54,515 - INFO - Starting data download process
2024-11-01 22:32:57,553 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:32:57,635 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:33:17,432 - INFO - Starting data loading process
2024-11-01 22:33:17,442 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:33:17,508 - INFO - Pickle file loaded successfully
2024-11-01 22:33:18,620 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:38:38,519 - INFO - Starting data download process
2024-11-01 22:38:41,242 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:38:41,367 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:38:55,043 - INFO - Starting data loading process
2024-11-01 22:38:55,050 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:38:55,112 - INFO - Pickle file loaded successfully
2024-11-01 22:38:55,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:47:23,050 - INFO - Starting data download process
2024-11-01 22:47:25,665 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:47:25,726 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:47:40,951 - INFO - Starting data loading process
2024-11-01 22:47:40,958 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:47:41,016 - INFO - Pickle file loaded successfully
2024-11-01 22:47:41,661 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 22:47:55,181 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 22:55:47,907 - INFO - Starting data download process
2024-11-01 22:55:52,874 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 22:55:53,337 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 22:56:11,546 - INFO - Starting data loading process
2024-11-01 22:56:11,554 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 22:56:11,757 - INFO - Pickle file loaded successfully
2024-11-01 22:56:12,563 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:03:24,914 - INFO - Starting data download process
2024-11-01 23:03:29,472 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:03:29,566 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:03:49,417 - INFO - Starting data loading process
2024-11-01 23:03:49,426 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:03:49,498 - INFO - Pickle file loaded successfully
2024-11-01 23:03:50,535 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:09:00,731 - INFO - Starting data download process
2024-11-01 23:09:02,375 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:09:02,414 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:09:30,416 - INFO - Starting data loading process
2024-11-01 23:09:30,428 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:09:30,498 - INFO - Pickle file loaded successfully
2024-11-01 23:09:31,763 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:09:32,120 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:09:51,843 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:41,568 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:14:58,884 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:20:17,486 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:25:24,322 - INFO - Starting data download process
2024-11-01 23:25:26,542 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:25:26,580 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:25:45,554 - INFO - Starting data loading process
2024-11-01 23:25:45,563 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:25:45,643 - INFO - Pickle file loaded successfully
2024-11-01 23:25:46,634 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:26:04,631 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:26:04,645 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:05,110 - INFO - Generated training data statistics.
2024-11-01 23:26:05,133 - INFO - Inferred schema from training data statistics.
2024-11-01 23:26:05,156 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:26:05,170 - INFO - Prepared training data with shape (31647, 17)
2024-11-01 23:26:05,490 - INFO - Generated training data statistics.
2024-11-01 23:26:05,505 - INFO - Statistics visualization complete.
2024-11-01 23:26:21,793 - INFO - Starting data processing...
2024-11-01 23:26:21,849 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:26:38,888 - INFO - Starting data processing
2024-11-01 23:26:38,893 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:26:39,040 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:26:39,724 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:26:41,373 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:26:42,278 - INFO - No duplicate rows found.
2024-11-01 23:26:46,063 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:26:46,072 - INFO - age: 0.00%
2024-11-01 23:26:46,079 - INFO - job: 0.64%
2024-11-01 23:26:46,086 - INFO - marital: 0.00%
2024-11-01 23:26:46,093 - INFO - education: 4.11%
2024-11-01 23:26:46,101 - INFO - default: 0.00%
2024-11-01 23:26:46,109 - INFO - balance: 0.00%
2024-11-01 23:26:46,119 - INFO - housing: 0.00%
2024-11-01 23:26:46,127 - INFO - loan: 0.00%
2024-11-01 23:26:46,134 - INFO - contact: 28.80%
2024-11-01 23:26:46,141 - INFO - day: 0.00%
2024-11-01 23:26:46,148 - INFO - month: 0.00%
2024-11-01 23:26:46,156 - INFO - duration: 0.00%
2024-11-01 23:26:46,164 - INFO - campaign: 0.00%
2024-11-01 23:26:46,172 - INFO - pdays: 0.00%
2024-11-01 23:26:46,181 - INFO - previous: 0.00%
2024-11-01 23:26:46,190 - INFO - poutcome: 81.75%
2024-11-01 23:26:46,197 - INFO - y: 0.00%
2024-11-01 23:26:46,218 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:26:46,331 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:26:46,447 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:26:46,551 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:26:46,559 - INFO - Data processing completed successfully
2024-11-01 23:27:23,452 - INFO - Starting EDA process
2024-11-01 23:27:23,456 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:27:23,587 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:23,604 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:27:23,609 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:27:23,791 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:27:23,811 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:27:25,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:27:29,008 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:27:29,558 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:27:29,909 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:27:29,935 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:27:30,448 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:27:30,896 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:27:31,336 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:27:31,692 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:27:32,142 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:27:33,040 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:27:33,048 - INFO - EDA process completed successfully
2024-11-01 23:27:45,995 - INFO - Starting categorical encoding process
2024-11-01 23:27:46,140 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:27:46,146 - INFO - Column datatypes:
2024-11-01 23:27:46,152 - INFO - age: float64
2024-11-01 23:27:46,159 - INFO - job: string
2024-11-01 23:27:46,163 - INFO - marital: string
2024-11-01 23:27:46,171 - INFO - education: string
2024-11-01 23:27:46,179 - INFO - default: string
2024-11-01 23:27:46,182 - INFO - balance: float64
2024-11-01 23:27:46,202 - INFO - housing: string
2024-11-01 23:27:46,214 - INFO - loan: string
2024-11-01 23:27:46,219 - INFO - contact: string
2024-11-01 23:27:46,226 - INFO - day: float64
2024-11-01 23:27:46,230 - INFO - month: string
2024-11-01 23:27:46,234 - INFO - duration: float64
2024-11-01 23:27:46,246 - INFO - campaign: float64
2024-11-01 23:27:46,249 - INFO - pdays: float64
2024-11-01 23:27:46,251 - INFO - previous: float64
2024-11-01 23:27:46,254 - INFO - y: string
2024-11-01 23:27:46,279 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:27:46,319 - INFO - Encoded column: job
2024-11-01 23:27:46,350 - INFO - Encoded column: marital
2024-11-01 23:27:46,383 - INFO - Encoded column: education
2024-11-01 23:27:46,413 - INFO - Encoded column: default
2024-11-01 23:27:46,440 - INFO - Encoded column: housing
2024-11-01 23:27:46,468 - INFO - Encoded column: loan
2024-11-01 23:27:46,494 - INFO - Encoded column: contact
2024-11-01 23:27:46,520 - INFO - Encoded column: month
2024-11-01 23:27:46,546 - INFO - Encoded column: y
2024-11-01 23:27:47,053 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:27:47,129 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:27:47,134 - INFO - Categorical encoding process completed successfully
2024-11-01 23:28:08,176 - INFO - Starting correlation analysis
2024-11-01 23:28:08,183 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:08,251 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:08,314 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:28:08,327 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:28:08,336 - INFO - No highly correlated pairs found.
2024-11-01 23:28:09,266 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:28:09,270 - INFO - Correlation analysis completed successfully
2024-11-01 23:28:16,146 - INFO - Starting SMOTE analysis
2024-11-01 23:28:16,151 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:28:16,202 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:28:16,215 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:28:16,310 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:28:16,315 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:28:16,320 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:28:17,081 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:28:17,172 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:28:17,242 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:28:17,272 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:28:17,279 - INFO - SMOTE analysis completed successfully
2024-11-01 23:41:36,508 - INFO - Starting data download process
2024-11-01 23:41:45,203 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:41:45,280 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:41:59,499 - INFO - Starting data loading process
2024-11-01 23:41:59,506 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:41:59,547 - INFO - Pickle file loaded successfully
2024-11-01 23:42:00,028 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:42:19,518 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:42:19,549 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:42:19,558 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:42:19,565 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:42:20,367 - INFO - Generated training data statistics.
2024-11-01 23:42:20,378 - INFO - Inferred schema from training data statistics.
2024-11-01 23:42:20,397 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:42:20,780 - INFO - Generated serving data statistics.
2024-11-01 23:42:20,812 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:42:21,069 - INFO - Generated training data statistics.
2024-11-01 23:49:19,151 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:49:19,171 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:49:19,178 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:49:19,185 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:49:19,537 - INFO - Generated training data statistics.
2024-11-01 23:49:19,548 - INFO - Inferred schema from training data statistics.
2024-11-01 23:49:19,566 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:49:19,811 - INFO - Generated serving data statistics.
2024-11-01 23:49:19,829 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:49:20,044 - INFO - Generated training data statistics.
2024-11-01 23:49:20,055 - INFO - Statistics visualization complete.
2024-11-01 23:49:39,060 - INFO - Starting data processing...
2024-11-01 23:49:39,067 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:49:48,977 - INFO - Starting data processing
2024-11-01 23:49:48,981 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:49:49,101 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:49:49,174 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:49:49,209 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:49:49,238 - INFO - No duplicate rows found.
2024-11-01 23:49:49,865 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:49:49,871 - INFO - age: 0.00%
2024-11-01 23:49:49,875 - INFO - job: 0.64%
2024-11-01 23:49:49,879 - INFO - marital: 0.00%
2024-11-01 23:49:49,882 - INFO - education: 4.11%
2024-11-01 23:49:49,885 - INFO - default: 0.00%
2024-11-01 23:49:49,888 - INFO - balance: 0.00%
2024-11-01 23:49:49,891 - INFO - housing: 0.00%
2024-11-01 23:49:49,893 - INFO - loan: 0.00%
2024-11-01 23:49:49,895 - INFO - contact: 28.80%
2024-11-01 23:49:49,897 - INFO - day: 0.00%
2024-11-01 23:49:49,900 - INFO - month: 0.00%
2024-11-01 23:49:49,903 - INFO - duration: 0.00%
2024-11-01 23:49:49,905 - INFO - campaign: 0.00%
2024-11-01 23:49:49,907 - INFO - pdays: 0.00%
2024-11-01 23:49:49,909 - INFO - previous: 0.00%
2024-11-01 23:49:49,911 - INFO - poutcome: 81.75%
2024-11-01 23:49:49,913 - INFO - y: 0.00%
2024-11-01 23:49:49,921 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:49:49,977 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:49:50,028 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:49:50,077 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:49:50,082 - INFO - Data processing completed successfully
2024-11-01 23:50:05,590 - INFO - Starting EDA process
2024-11-01 23:50:05,595 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:50:05,708 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:05,723 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:50:05,728 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:50:05,864 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:50:05,874 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:50:06,053 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:50:06,193 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:50:06,327 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:50:06,450 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:50:06,458 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:50:06,660 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:50:06,822 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:50:06,987 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:50:07,124 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:50:07,273 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:50:07,664 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:07,669 - INFO - EDA process completed successfully
2024-11-01 23:50:19,505 - INFO - Starting categorical encoding process
2024-11-01 23:50:21,350 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:50:21,392 - INFO - Column datatypes:
2024-11-01 23:50:21,445 - INFO - age: float64
2024-11-01 23:50:21,491 - INFO - job: string
2024-11-01 23:50:21,526 - INFO - marital: string
2024-11-01 23:50:21,573 - INFO - education: string
2024-11-01 23:50:21,605 - INFO - default: string
2024-11-01 23:50:21,638 - INFO - balance: float64
2024-11-01 23:50:21,692 - INFO - housing: string
2024-11-01 23:50:21,727 - INFO - loan: string
2024-11-01 23:50:21,759 - INFO - contact: string
2024-11-01 23:50:21,796 - INFO - day: float64
2024-11-01 23:50:21,829 - INFO - month: string
2024-11-01 23:50:21,863 - INFO - duration: float64
2024-11-01 23:50:21,897 - INFO - campaign: float64
2024-11-01 23:50:21,931 - INFO - pdays: float64
2024-11-01 23:50:21,974 - INFO - previous: float64
2024-11-01 23:50:22,020 - INFO - y: string
2024-11-01 23:50:22,208 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:50:22,497 - INFO - Encoded column: job
2024-11-01 23:50:22,579 - INFO - Encoded column: marital
2024-11-01 23:50:22,655 - INFO - Encoded column: education
2024-11-01 23:50:22,730 - INFO - Encoded column: default
2024-11-01 23:50:22,857 - INFO - Encoded column: housing
2024-11-01 23:50:22,931 - INFO - Encoded column: loan
2024-11-01 23:50:22,988 - INFO - Encoded column: contact
2024-11-01 23:50:23,048 - INFO - Encoded column: month
2024-11-01 23:50:23,104 - INFO - Encoded column: y
2024-11-01 23:50:23,985 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:50:24,173 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:24,182 - INFO - Categorical encoding process completed successfully
2024-11-01 23:50:39,063 - INFO - Starting correlation analysis
2024-11-01 23:50:39,068 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:39,105 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:39,159 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:50:39,164 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:50:39,172 - INFO - No highly correlated pairs found.
2024-11-01 23:50:40,109 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:50:40,114 - INFO - Correlation analysis completed successfully
2024-11-01 23:50:47,981 - INFO - Starting SMOTE analysis
2024-11-01 23:50:47,984 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:50:48,025 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:50:48,037 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:50:48,160 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:50:48,163 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:50:48,168 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:50:48,912 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:50:48,991 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:50:49,057 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:50:49,077 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:50:49,080 - INFO - SMOTE analysis completed successfully
2024-11-01 23:51:40,099 - INFO - Starting data download process
2024-11-01 23:51:43,193 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-01 23:51:43,235 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-01 23:51:51,010 - INFO - Starting data loading process
2024-11-01 23:51:51,013 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-01 23:51:51,041 - INFO - Pickle file loaded successfully
2024-11-01 23:51:56,651 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:52:11,493 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-01 23:52:11,504 - INFO - Prepared training data with shape (27126, 17)
2024-11-01 23:52:11,509 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-01 23:52:11,514 - INFO - Prepared serving data with shape (9043, 16)
2024-11-01 23:52:11,684 - INFO - Generated training data statistics.
2024-11-01 23:52:11,690 - INFO - Inferred schema from training data statistics.
2024-11-01 23:52:11,699 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-01 23:52:11,797 - INFO - Generated serving data statistics.
2024-11-01 23:52:11,807 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-01 23:52:11,904 - INFO - Generated training data statistics.
2024-11-01 23:52:11,911 - INFO - Statistics visualization complete.
2024-11-01 23:52:38,934 - INFO - Starting data processing...
2024-11-01 23:52:38,944 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-01 23:52:54,088 - INFO - Starting data processing
2024-11-01 23:52:54,094 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-01 23:52:54,241 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-01 23:52:54,327 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-01 23:52:54,364 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-01 23:52:54,394 - INFO - No duplicate rows found.
2024-11-01 23:52:55,131 - INFO - Percentage of null or unknown values in each column:
2024-11-01 23:52:55,136 - INFO - age: 0.00%
2024-11-01 23:52:55,141 - INFO - job: 0.64%
2024-11-01 23:52:55,144 - INFO - marital: 0.00%
2024-11-01 23:52:55,146 - INFO - education: 4.11%
2024-11-01 23:52:55,150 - INFO - default: 0.00%
2024-11-01 23:52:55,153 - INFO - balance: 0.00%
2024-11-01 23:52:55,157 - INFO - housing: 0.00%
2024-11-01 23:52:55,160 - INFO - loan: 0.00%
2024-11-01 23:52:55,164 - INFO - contact: 28.80%
2024-11-01 23:52:55,167 - INFO - day: 0.00%
2024-11-01 23:52:55,170 - INFO - month: 0.00%
2024-11-01 23:52:55,175 - INFO - duration: 0.00%
2024-11-01 23:52:55,178 - INFO - campaign: 0.00%
2024-11-01 23:52:55,182 - INFO - pdays: 0.00%
2024-11-01 23:52:55,186 - INFO - previous: 0.00%
2024-11-01 23:52:55,189 - INFO - poutcome: 81.75%
2024-11-01 23:52:55,193 - INFO - y: 0.00%
2024-11-01 23:52:55,202 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-01 23:52:55,266 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-01 23:52:55,317 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-01 23:52:55,374 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-01 23:52:55,378 - INFO - Data processing completed successfully
2024-11-01 23:53:13,667 - INFO - Starting EDA process
2024-11-01 23:53:13,671 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-01 23:53:13,815 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:13,832 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-01 23:53:13,835 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-01 23:53:13,999 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-01 23:53:14,011 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-01 23:53:15,058 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-01 23:53:17,892 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-01 23:53:19,405 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-01 23:53:19,851 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-01 23:53:19,876 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-01 23:53:20,443 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-01 23:53:20,927 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-01 23:53:21,464 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-01 23:53:21,904 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-01 23:53:22,352 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-01 23:53:23,577 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:23,584 - INFO - EDA process completed successfully
2024-11-01 23:53:37,200 - INFO - Starting categorical encoding process
2024-11-01 23:53:37,329 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-01 23:53:37,335 - INFO - Column datatypes:
2024-11-01 23:53:37,341 - INFO - age: float64
2024-11-01 23:53:37,345 - INFO - job: string
2024-11-01 23:53:37,348 - INFO - marital: string
2024-11-01 23:53:37,352 - INFO - education: string
2024-11-01 23:53:37,355 - INFO - default: string
2024-11-01 23:53:37,358 - INFO - balance: float64
2024-11-01 23:53:37,361 - INFO - housing: string
2024-11-01 23:53:37,363 - INFO - loan: string
2024-11-01 23:53:37,366 - INFO - contact: string
2024-11-01 23:53:37,369 - INFO - day: float64
2024-11-01 23:53:37,372 - INFO - month: string
2024-11-01 23:53:37,376 - INFO - duration: float64
2024-11-01 23:53:37,379 - INFO - campaign: float64
2024-11-01 23:53:37,381 - INFO - pdays: float64
2024-11-01 23:53:37,384 - INFO - previous: float64
2024-11-01 23:53:37,388 - INFO - y: string
2024-11-01 23:53:37,406 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-01 23:53:37,435 - INFO - Encoded column: job
2024-11-01 23:53:37,462 - INFO - Encoded column: marital
2024-11-01 23:53:37,488 - INFO - Encoded column: education
2024-11-01 23:53:37,513 - INFO - Encoded column: default
2024-11-01 23:53:37,540 - INFO - Encoded column: housing
2024-11-01 23:53:37,563 - INFO - Encoded column: loan
2024-11-01 23:53:37,586 - INFO - Encoded column: contact
2024-11-01 23:53:37,610 - INFO - Encoded column: month
2024-11-01 23:53:37,633 - INFO - Encoded column: y
2024-11-01 23:53:38,011 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-01 23:53:38,063 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:38,067 - INFO - Categorical encoding process completed successfully
2024-11-01 23:53:45,448 - INFO - Starting correlation analysis
2024-11-01 23:53:45,454 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:53:45,507 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:53:45,586 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-01 23:53:45,595 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-01 23:53:45,607 - INFO - No highly correlated pairs found.
2024-11-01 23:53:51,990 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-01 23:53:51,997 - INFO - Correlation analysis completed successfully
2024-11-01 23:54:07,139 - INFO - Starting SMOTE analysis
2024-11-01 23:54:07,147 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-01 23:54:07,257 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-01 23:54:07,310 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-01 23:54:07,551 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-01 23:54:07,559 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-01 23:54:07,565 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-01 23:54:08,251 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-01 23:54:08,336 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-01 23:54:08,397 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-01 23:54:08,421 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-01 23:54:08,426 - INFO - SMOTE analysis completed successfully
2024-11-02 00:31:51,418 - INFO - Starting data download process
2024-11-02 00:31:55,872 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 00:31:55,909 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 00:32:14,820 - INFO - Starting data loading process
2024-11-02 00:32:14,829 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 00:32:14,899 - INFO - Pickle file loaded successfully
2024-11-02 00:32:16,035 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 00:32:25,465 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 00:32:25,478 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 00:32:25,484 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 00:32:25,490 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 00:32:25,710 - INFO - Generated training data statistics.
2024-11-02 00:32:25,721 - INFO - Inferred schema from training data statistics.
2024-11-02 00:32:25,734 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 00:32:25,871 - INFO - Generated serving data statistics.
2024-11-02 00:32:25,890 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 00:32:26,055 - INFO - Generated training data statistics.
2024-11-02 00:32:26,061 - INFO - Statistics visualization complete.
2024-11-02 00:32:34,011 - INFO - Starting data processing...
2024-11-02 00:32:34,016 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 00:32:54,833 - INFO - Starting data processing
2024-11-02 00:32:54,842 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 00:32:55,187 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 00:32:55,368 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 00:32:55,453 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 00:32:55,525 - INFO - No duplicate rows found.
2024-11-02 00:32:56,737 - INFO - Percentage of null or unknown values in each column:
2024-11-02 00:32:56,741 - INFO - age: 0.00%
2024-11-02 00:32:56,744 - INFO - job: 0.64%
2024-11-02 00:32:56,746 - INFO - marital: 0.00%
2024-11-02 00:32:56,749 - INFO - education: 4.11%
2024-11-02 00:32:56,751 - INFO - default: 0.00%
2024-11-02 00:32:56,754 - INFO - balance: 0.00%
2024-11-02 00:32:56,757 - INFO - housing: 0.00%
2024-11-02 00:32:56,760 - INFO - loan: 0.00%
2024-11-02 00:32:56,763 - INFO - contact: 28.80%
2024-11-02 00:32:56,766 - INFO - day: 0.00%
2024-11-02 00:32:56,769 - INFO - month: 0.00%
2024-11-02 00:32:56,772 - INFO - duration: 0.00%
2024-11-02 00:32:56,776 - INFO - campaign: 0.00%
2024-11-02 00:32:56,779 - INFO - pdays: 0.00%
2024-11-02 00:32:56,782 - INFO - previous: 0.00%
2024-11-02 00:32:56,786 - INFO - poutcome: 81.75%
2024-11-02 00:32:56,790 - INFO - y: 0.00%
2024-11-02 00:32:56,801 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 00:32:56,855 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 00:32:56,915 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 00:32:56,964 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 00:32:56,968 - INFO - Data processing completed successfully
2024-11-02 00:33:42,137 - INFO - Starting EDA process
2024-11-02 00:33:42,141 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 00:33:42,265 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 00:33:42,283 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 00:33:42,287 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 00:33:42,461 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 00:33:42,473 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 00:33:43,600 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 00:33:47,893 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 00:33:48,939 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 00:33:49,286 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 00:33:49,312 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 00:33:49,764 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 00:33:50,330 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 00:33:50,765 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 00:33:51,201 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 00:33:51,741 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 00:33:53,578 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 00:33:53,586 - INFO - EDA process completed successfully
2024-11-02 00:34:06,941 - INFO - Starting categorical encoding process
2024-11-02 00:34:07,070 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 00:34:07,075 - INFO - Column datatypes:
2024-11-02 00:34:07,081 - INFO - age: float64
2024-11-02 00:34:07,085 - INFO - job: string
2024-11-02 00:34:07,089 - INFO - marital: string
2024-11-02 00:34:07,091 - INFO - education: string
2024-11-02 00:34:07,095 - INFO - default: string
2024-11-02 00:34:07,099 - INFO - balance: float64
2024-11-02 00:34:07,102 - INFO - housing: string
2024-11-02 00:34:07,104 - INFO - loan: string
2024-11-02 00:34:07,106 - INFO - contact: string
2024-11-02 00:34:07,109 - INFO - day: float64
2024-11-02 00:34:07,115 - INFO - month: string
2024-11-02 00:34:07,119 - INFO - duration: float64
2024-11-02 00:34:07,123 - INFO - campaign: float64
2024-11-02 00:34:07,126 - INFO - pdays: float64
2024-11-02 00:34:07,131 - INFO - previous: float64
2024-11-02 00:34:07,134 - INFO - y: string
2024-11-02 00:34:07,154 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 00:34:07,185 - INFO - Encoded column: job
2024-11-02 00:34:07,212 - INFO - Encoded column: marital
2024-11-02 00:34:07,239 - INFO - Encoded column: education
2024-11-02 00:34:07,272 - INFO - Encoded column: default
2024-11-02 00:34:07,307 - INFO - Encoded column: housing
2024-11-02 00:34:07,336 - INFO - Encoded column: loan
2024-11-02 00:34:07,364 - INFO - Encoded column: contact
2024-11-02 00:34:07,387 - INFO - Encoded column: month
2024-11-02 00:34:07,509 - INFO - Encoded column: y
2024-11-02 00:34:07,924 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 00:34:07,985 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 00:34:07,988 - INFO - Categorical encoding process completed successfully
2024-11-02 00:34:15,990 - INFO - Starting correlation analysis
2024-11-02 00:34:15,995 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 00:34:16,055 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 00:34:16,114 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 00:34:16,124 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 00:34:16,137 - INFO - No highly correlated pairs found.
2024-11-02 00:34:17,232 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 00:34:17,237 - INFO - Correlation analysis completed successfully
2024-11-02 00:34:38,129 - INFO - Starting SMOTE analysis
2024-11-02 00:34:38,139 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 00:34:38,268 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 00:34:38,306 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 00:34:38,593 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 00:34:38,603 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 00:34:38,616 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 00:34:39,677 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 00:34:39,782 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 00:34:39,860 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 00:34:39,880 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 00:34:39,884 - INFO - SMOTE analysis completed successfully
2024-11-02 04:10:46,533 - INFO - Starting data download process
2024-11-02 04:10:50,356 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 04:10:50,433 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 04:11:10,157 - INFO - Starting data loading process
2024-11-02 04:11:10,166 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 04:11:10,236 - INFO - Pickle file loaded successfully
2024-11-02 04:11:11,398 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:11:28,011 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 04:11:28,034 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 04:11:28,043 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 04:11:28,052 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 04:11:28,414 - INFO - Generated training data statistics.
2024-11-02 04:11:28,433 - INFO - Inferred schema from training data statistics.
2024-11-02 04:11:28,453 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 04:11:28,642 - INFO - Generated serving data statistics.
2024-11-02 04:11:28,662 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 04:11:28,852 - INFO - Generated training data statistics.
2024-11-02 04:11:28,866 - INFO - Statistics visualization complete.
2024-11-02 04:11:42,998 - INFO - Starting data processing...
2024-11-02 04:11:43,003 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 04:12:02,169 - INFO - Starting data processing
2024-11-02 04:12:02,180 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:12:02,462 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 04:12:02,649 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 04:12:02,723 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 04:12:02,790 - INFO - No duplicate rows found.
2024-11-02 04:12:04,525 - INFO - Percentage of null or unknown values in each column:
2024-11-02 04:12:04,533 - INFO - age: 0.00%
2024-11-02 04:12:04,544 - INFO - job: 0.64%
2024-11-02 04:12:04,550 - INFO - marital: 0.00%
2024-11-02 04:12:04,556 - INFO - education: 4.11%
2024-11-02 04:12:04,564 - INFO - default: 0.00%
2024-11-02 04:12:04,569 - INFO - balance: 0.00%
2024-11-02 04:12:04,574 - INFO - housing: 0.00%
2024-11-02 04:12:04,579 - INFO - loan: 0.00%
2024-11-02 04:12:04,582 - INFO - contact: 28.80%
2024-11-02 04:12:04,585 - INFO - day: 0.00%
2024-11-02 04:12:04,588 - INFO - month: 0.00%
2024-11-02 04:12:04,592 - INFO - duration: 0.00%
2024-11-02 04:12:04,595 - INFO - campaign: 0.00%
2024-11-02 04:12:04,599 - INFO - pdays: 0.00%
2024-11-02 04:12:04,603 - INFO - previous: 0.00%
2024-11-02 04:12:04,606 - INFO - poutcome: 81.75%
2024-11-02 04:12:04,718 - INFO - y: 0.00%
2024-11-02 04:12:04,729 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 04:12:04,783 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 04:12:04,837 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 04:12:04,895 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 04:12:04,899 - INFO - Data processing completed successfully
2024-11-02 04:12:34,429 - INFO - Starting EDA process
2024-11-02 04:12:34,434 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 04:12:34,590 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:12:34,607 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 04:12:34,614 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 04:12:34,794 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 04:12:34,807 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 04:12:35,015 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 04:12:35,213 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 04:12:35,424 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 04:12:35,597 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 04:12:35,611 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 04:12:35,860 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 04:12:36,096 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 04:12:36,326 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 04:12:36,503 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 04:12:36,671 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 04:12:37,152 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:12:37,158 - INFO - EDA process completed successfully
2024-11-02 04:12:45,206 - INFO - Starting categorical encoding process
2024-11-02 04:12:45,363 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:12:45,368 - INFO - Column datatypes:
2024-11-02 04:12:45,375 - INFO - age: float64
2024-11-02 04:12:45,381 - INFO - job: string
2024-11-02 04:12:45,387 - INFO - marital: string
2024-11-02 04:12:45,392 - INFO - education: string
2024-11-02 04:12:45,397 - INFO - default: string
2024-11-02 04:12:45,401 - INFO - balance: float64
2024-11-02 04:12:45,405 - INFO - housing: string
2024-11-02 04:12:45,411 - INFO - loan: string
2024-11-02 04:12:45,415 - INFO - contact: string
2024-11-02 04:12:45,420 - INFO - day: float64
2024-11-02 04:12:45,425 - INFO - month: string
2024-11-02 04:12:45,431 - INFO - duration: float64
2024-11-02 04:12:45,437 - INFO - campaign: float64
2024-11-02 04:12:45,443 - INFO - pdays: float64
2024-11-02 04:12:45,449 - INFO - previous: float64
2024-11-02 04:12:45,454 - INFO - y: string
2024-11-02 04:12:45,487 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 04:12:45,532 - INFO - Encoded column: job
2024-11-02 04:12:45,576 - INFO - Encoded column: marital
2024-11-02 04:12:45,607 - INFO - Encoded column: education
2024-11-02 04:12:45,637 - INFO - Encoded column: default
2024-11-02 04:12:45,669 - INFO - Encoded column: housing
2024-11-02 04:12:45,699 - INFO - Encoded column: loan
2024-11-02 04:12:45,734 - INFO - Encoded column: contact
2024-11-02 04:12:45,771 - INFO - Encoded column: month
2024-11-02 04:12:45,802 - INFO - Encoded column: y
2024-11-02 04:12:46,272 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 04:12:46,319 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:12:46,324 - INFO - Categorical encoding process completed successfully
2024-11-02 04:13:07,911 - INFO - Starting correlation analysis
2024-11-02 04:13:07,914 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:13:07,955 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:13:08,009 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 04:13:08,017 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 04:13:08,027 - INFO - No highly correlated pairs found.
2024-11-02 04:13:14,336 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:13:14,344 - INFO - Correlation analysis completed successfully
2024-11-02 04:13:27,722 - INFO - Starting SMOTE analysis
2024-11-02 04:13:27,729 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:13:27,795 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:13:27,826 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 04:13:27,980 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 04:13:27,983 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 04:13:27,989 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 04:13:28,891 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 04:13:28,980 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 04:13:29,048 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 04:13:29,067 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 04:13:29,071 - INFO - SMOTE analysis completed successfully
2024-11-02 04:24:32,244 - INFO - Starting data download process
2024-11-02 04:24:39,120 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 04:24:39,202 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 04:24:53,698 - INFO - Starting data loading process
2024-11-02 04:24:53,704 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 04:24:53,755 - INFO - Pickle file loaded successfully
2024-11-02 04:24:54,349 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:25:08,441 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 04:25:08,468 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 04:25:08,476 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 04:25:08,483 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 04:25:08,863 - INFO - Generated training data statistics.
2024-11-02 04:25:08,875 - INFO - Inferred schema from training data statistics.
2024-11-02 04:25:08,893 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 04:25:09,195 - INFO - Generated serving data statistics.
2024-11-02 04:25:09,217 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 04:25:09,565 - INFO - Generated training data statistics.
2024-11-02 04:25:09,576 - INFO - Statistics visualization complete.
2024-11-02 04:25:29,755 - INFO - Starting data processing...
2024-11-02 04:25:29,762 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 04:25:49,350 - INFO - Starting data processing
2024-11-02 04:25:49,358 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:25:49,639 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 04:25:49,832 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 04:25:49,906 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 04:25:49,980 - INFO - No duplicate rows found.
2024-11-02 04:25:51,691 - INFO - Percentage of null or unknown values in each column:
2024-11-02 04:25:51,700 - INFO - age: 0.00%
2024-11-02 04:25:51,708 - INFO - job: 0.64%
2024-11-02 04:25:51,717 - INFO - marital: 0.00%
2024-11-02 04:25:51,724 - INFO - education: 4.11%
2024-11-02 04:25:51,732 - INFO - default: 0.00%
2024-11-02 04:25:51,739 - INFO - balance: 0.00%
2024-11-02 04:25:51,746 - INFO - housing: 0.00%
2024-11-02 04:25:51,753 - INFO - loan: 0.00%
2024-11-02 04:25:51,760 - INFO - contact: 28.80%
2024-11-02 04:25:51,768 - INFO - day: 0.00%
2024-11-02 04:25:51,774 - INFO - month: 0.00%
2024-11-02 04:25:51,781 - INFO - duration: 0.00%
2024-11-02 04:25:51,788 - INFO - campaign: 0.00%
2024-11-02 04:25:51,795 - INFO - pdays: 0.00%
2024-11-02 04:25:51,804 - INFO - previous: 0.00%
2024-11-02 04:25:51,814 - INFO - poutcome: 81.75%
2024-11-02 04:25:51,821 - INFO - y: 0.00%
2024-11-02 04:25:51,845 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 04:25:52,022 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 04:25:52,148 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 04:25:52,253 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 04:25:52,263 - INFO - Data processing completed successfully
2024-11-02 04:26:29,481 - INFO - Starting EDA process
2024-11-02 04:26:29,510 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 04:26:29,824 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:26:29,866 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 04:26:29,876 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 04:26:30,243 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 04:26:30,263 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 04:26:30,586 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 04:26:30,883 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 04:26:31,278 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 04:26:31,524 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 04:26:31,540 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 04:26:32,123 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 04:26:32,623 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 04:26:32,959 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 04:26:33,335 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 04:26:33,676 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 04:26:34,692 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:26:34,699 - INFO - EDA process completed successfully
2024-11-02 04:26:48,532 - INFO - Starting categorical encoding process
2024-11-02 04:26:48,739 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:26:48,747 - INFO - Column datatypes:
2024-11-02 04:26:48,757 - INFO - age: float64
2024-11-02 04:26:48,766 - INFO - job: string
2024-11-02 04:26:48,774 - INFO - marital: string
2024-11-02 04:26:48,781 - INFO - education: string
2024-11-02 04:26:48,793 - INFO - default: string
2024-11-02 04:26:48,799 - INFO - balance: float64
2024-11-02 04:26:48,807 - INFO - housing: string
2024-11-02 04:26:48,812 - INFO - loan: string
2024-11-02 04:26:48,818 - INFO - contact: string
2024-11-02 04:26:48,826 - INFO - day: float64
2024-11-02 04:26:48,833 - INFO - month: string
2024-11-02 04:26:48,839 - INFO - duration: float64
2024-11-02 04:26:48,845 - INFO - campaign: float64
2024-11-02 04:26:48,852 - INFO - pdays: float64
2024-11-02 04:26:48,857 - INFO - previous: float64
2024-11-02 04:26:48,863 - INFO - y: string
2024-11-02 04:26:48,893 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 04:26:48,937 - INFO - Encoded column: job
2024-11-02 04:26:48,992 - INFO - Encoded column: marital
2024-11-02 04:26:49,042 - INFO - Encoded column: education
2024-11-02 04:26:49,094 - INFO - Encoded column: default
2024-11-02 04:26:49,158 - INFO - Encoded column: housing
2024-11-02 04:26:49,220 - INFO - Encoded column: loan
2024-11-02 04:26:49,262 - INFO - Encoded column: contact
2024-11-02 04:26:49,303 - INFO - Encoded column: month
2024-11-02 04:26:49,344 - INFO - Encoded column: y
2024-11-02 04:26:50,096 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 04:26:50,313 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:26:50,328 - INFO - Categorical encoding process completed successfully
2024-11-02 04:27:07,807 - INFO - Starting correlation analysis
2024-11-02 04:27:07,815 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:27:07,918 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:27:08,012 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 04:27:08,028 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 04:27:08,046 - INFO - No highly correlated pairs found.
2024-11-02 04:27:09,787 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:27:09,794 - INFO - Correlation analysis completed successfully
2024-11-02 04:27:25,152 - INFO - Starting SMOTE analysis
2024-11-02 04:27:25,159 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:27:25,267 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:27:25,294 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 04:27:25,577 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 04:27:25,583 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 04:27:25,592 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 04:27:26,974 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 04:27:27,142 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 04:27:27,279 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 04:27:27,316 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 04:27:27,322 - INFO - SMOTE analysis completed successfully
2024-11-02 04:47:20,623 - INFO - Starting data download process
2024-11-02 04:47:25,201 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 04:47:27,083 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 04:47:42,971 - INFO - Starting data loading process
2024-11-02 04:47:42,981 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 04:47:43,051 - INFO - Pickle file loaded successfully
2024-11-02 04:47:43,947 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:48:01,821 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 04:48:01,846 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 04:48:01,853 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 04:48:01,860 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 04:48:02,480 - INFO - Generated training data statistics.
2024-11-02 04:48:02,491 - INFO - Inferred schema from training data statistics.
2024-11-02 04:48:02,522 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 04:48:02,879 - INFO - Generated serving data statistics.
2024-11-02 04:48:02,914 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 04:48:03,309 - INFO - Generated training data statistics.
2024-11-02 04:48:03,335 - INFO - Statistics visualization complete.
2024-11-02 04:48:19,302 - INFO - Starting data processing...
2024-11-02 04:48:19,312 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 04:48:33,787 - INFO - Starting data processing
2024-11-02 04:48:33,809 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:48:34,398 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 04:48:34,719 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 04:48:34,865 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 04:48:34,986 - INFO - No duplicate rows found.
2024-11-02 04:48:36,784 - INFO - Percentage of null or unknown values in each column:
2024-11-02 04:48:36,797 - INFO - age: 0.00%
2024-11-02 04:48:36,810 - INFO - job: 0.64%
2024-11-02 04:48:36,823 - INFO - marital: 0.00%
2024-11-02 04:48:36,836 - INFO - education: 4.11%
2024-11-02 04:48:36,848 - INFO - default: 0.00%
2024-11-02 04:48:36,862 - INFO - balance: 0.00%
2024-11-02 04:48:36,876 - INFO - housing: 0.00%
2024-11-02 04:48:36,888 - INFO - loan: 0.00%
2024-11-02 04:48:36,901 - INFO - contact: 28.80%
2024-11-02 04:48:36,915 - INFO - day: 0.00%
2024-11-02 04:48:36,928 - INFO - month: 0.00%
2024-11-02 04:48:36,940 - INFO - duration: 0.00%
2024-11-02 04:48:36,953 - INFO - campaign: 0.00%
2024-11-02 04:48:36,967 - INFO - pdays: 0.00%
2024-11-02 04:48:36,980 - INFO - previous: 0.00%
2024-11-02 04:48:36,993 - INFO - poutcome: 81.75%
2024-11-02 04:48:37,005 - INFO - y: 0.00%
2024-11-02 04:48:37,038 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 04:48:37,242 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 04:48:37,459 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 04:48:37,676 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 04:48:37,692 - INFO - Data processing completed successfully
2024-11-02 04:49:13,835 - INFO - Starting EDA process
2024-11-02 04:49:13,856 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 04:49:14,344 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:49:14,410 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 04:49:14,525 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 04:49:15,180 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 04:49:15,222 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 04:49:15,707 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 04:49:15,989 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 04:49:16,292 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 04:49:16,575 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 04:49:16,591 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 04:49:17,012 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 04:49:17,634 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 04:49:18,035 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 04:49:18,559 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 04:49:19,035 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 04:49:20,421 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:49:20,443 - INFO - EDA process completed successfully
2024-11-02 04:49:38,776 - INFO - Starting categorical encoding process
2024-11-02 04:49:39,030 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 04:49:39,035 - INFO - Column datatypes:
2024-11-02 04:49:39,042 - INFO - age: float64
2024-11-02 04:49:39,047 - INFO - job: string
2024-11-02 04:49:39,052 - INFO - marital: string
2024-11-02 04:49:39,057 - INFO - education: string
2024-11-02 04:49:39,063 - INFO - default: string
2024-11-02 04:49:39,069 - INFO - balance: float64
2024-11-02 04:49:39,075 - INFO - housing: string
2024-11-02 04:49:39,082 - INFO - loan: string
2024-11-02 04:49:39,089 - INFO - contact: string
2024-11-02 04:49:39,096 - INFO - day: float64
2024-11-02 04:49:39,102 - INFO - month: string
2024-11-02 04:49:39,109 - INFO - duration: float64
2024-11-02 04:49:39,114 - INFO - campaign: float64
2024-11-02 04:49:39,120 - INFO - pdays: float64
2024-11-02 04:49:39,126 - INFO - previous: float64
2024-11-02 04:49:39,131 - INFO - y: string
2024-11-02 04:49:39,165 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 04:49:39,232 - INFO - Encoded column: job
2024-11-02 04:49:39,302 - INFO - Encoded column: marital
2024-11-02 04:49:39,375 - INFO - Encoded column: education
2024-11-02 04:49:39,430 - INFO - Encoded column: default
2024-11-02 04:49:39,476 - INFO - Encoded column: housing
2024-11-02 04:49:39,527 - INFO - Encoded column: loan
2024-11-02 04:49:39,585 - INFO - Encoded column: contact
2024-11-02 04:49:39,648 - INFO - Encoded column: month
2024-11-02 04:49:39,712 - INFO - Encoded column: y
2024-11-02 04:49:40,377 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 04:49:40,478 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:49:40,485 - INFO - Categorical encoding process completed successfully
2024-11-02 04:49:54,689 - INFO - Starting correlation analysis
2024-11-02 04:49:54,699 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:49:54,836 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:49:55,011 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 04:49:55,042 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 04:49:55,076 - INFO - No highly correlated pairs found.
2024-11-02 04:49:57,215 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 04:49:57,224 - INFO - Correlation analysis completed successfully
2024-11-02 04:50:16,539 - INFO - Starting SMOTE analysis
2024-11-02 04:50:16,546 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 04:50:16,635 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 04:50:16,659 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 04:50:16,842 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 04:50:16,849 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 04:50:16,859 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 04:50:18,129 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 04:50:18,285 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 04:50:18,408 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 04:50:18,443 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 04:50:18,450 - INFO - SMOTE analysis completed successfully
2024-11-02 04:59:08,836 - INFO - Starting data download process
2024-11-02 04:59:15,169 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 04:59:15,264 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 04:59:31,928 - INFO - Starting data loading process
2024-11-02 04:59:31,932 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 04:59:31,994 - INFO - Pickle file loaded successfully
2024-11-02 04:59:32,481 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 04:59:49,873 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 04:59:49,896 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 04:59:49,901 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 04:59:49,906 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 04:59:50,307 - INFO - Generated training data statistics.
2024-11-02 04:59:50,318 - INFO - Inferred schema from training data statistics.
2024-11-02 04:59:50,337 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 04:59:50,570 - INFO - Generated serving data statistics.
2024-11-02 04:59:50,587 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 04:59:50,833 - INFO - Generated training data statistics.
2024-11-02 04:59:50,846 - INFO - Statistics visualization complete.
2024-11-02 05:00:10,123 - INFO - Starting data processing...
2024-11-02 05:00:10,131 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 05:00:29,011 - INFO - Starting data processing
2024-11-02 05:00:29,020 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 05:00:29,256 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 05:00:29,414 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 05:00:29,479 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 05:00:29,541 - INFO - No duplicate rows found.
2024-11-02 05:00:30,379 - INFO - Percentage of null or unknown values in each column:
2024-11-02 05:00:30,384 - INFO - age: 0.00%
2024-11-02 05:00:30,389 - INFO - job: 0.64%
2024-11-02 05:00:30,393 - INFO - marital: 0.00%
2024-11-02 05:00:30,397 - INFO - education: 4.11%
2024-11-02 05:00:30,400 - INFO - default: 0.00%
2024-11-02 05:00:30,403 - INFO - balance: 0.00%
2024-11-02 05:00:30,406 - INFO - housing: 0.00%
2024-11-02 05:00:30,409 - INFO - loan: 0.00%
2024-11-02 05:00:30,412 - INFO - contact: 28.80%
2024-11-02 05:00:30,415 - INFO - day: 0.00%
2024-11-02 05:00:30,418 - INFO - month: 0.00%
2024-11-02 05:00:30,421 - INFO - duration: 0.00%
2024-11-02 05:00:30,424 - INFO - campaign: 0.00%
2024-11-02 05:00:30,427 - INFO - pdays: 0.00%
2024-11-02 05:00:30,430 - INFO - previous: 0.00%
2024-11-02 05:00:30,432 - INFO - poutcome: 81.75%
2024-11-02 05:00:30,435 - INFO - y: 0.00%
2024-11-02 05:00:30,444 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 05:00:30,491 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 05:00:30,538 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 05:00:30,594 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 05:00:30,598 - INFO - Data processing completed successfully
2024-11-02 05:01:13,540 - INFO - Starting EDA process
2024-11-02 05:01:13,549 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 05:01:13,807 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:01:13,837 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 05:01:13,846 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 05:01:14,136 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 05:01:14,158 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 05:01:14,539 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 05:01:14,883 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 05:01:15,234 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 05:01:15,392 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 05:01:15,406 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 05:01:15,608 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 05:01:15,789 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 05:01:15,964 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 05:01:16,117 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 05:01:16,278 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 05:01:16,737 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:01:16,741 - INFO - EDA process completed successfully
2024-11-02 05:01:35,184 - INFO - Starting categorical encoding process
2024-11-02 05:01:35,454 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:01:35,463 - INFO - Column datatypes:
2024-11-02 05:01:35,472 - INFO - age: float64
2024-11-02 05:01:35,478 - INFO - job: string
2024-11-02 05:01:35,483 - INFO - marital: string
2024-11-02 05:01:35,489 - INFO - education: string
2024-11-02 05:01:35,497 - INFO - default: string
2024-11-02 05:01:35,504 - INFO - balance: float64
2024-11-02 05:01:35,509 - INFO - housing: string
2024-11-02 05:01:35,515 - INFO - loan: string
2024-11-02 05:01:35,520 - INFO - contact: string
2024-11-02 05:01:35,525 - INFO - day: float64
2024-11-02 05:01:35,530 - INFO - month: string
2024-11-02 05:01:35,536 - INFO - duration: float64
2024-11-02 05:01:35,542 - INFO - campaign: float64
2024-11-02 05:01:35,549 - INFO - pdays: float64
2024-11-02 05:01:35,557 - INFO - previous: float64
2024-11-02 05:01:35,565 - INFO - y: string
2024-11-02 05:01:35,599 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 05:01:35,653 - INFO - Encoded column: job
2024-11-02 05:01:35,717 - INFO - Encoded column: marital
2024-11-02 05:01:35,769 - INFO - Encoded column: education
2024-11-02 05:01:35,825 - INFO - Encoded column: default
2024-11-02 05:01:35,880 - INFO - Encoded column: housing
2024-11-02 05:01:35,931 - INFO - Encoded column: loan
2024-11-02 05:01:35,978 - INFO - Encoded column: contact
2024-11-02 05:01:36,022 - INFO - Encoded column: month
2024-11-02 05:01:36,072 - INFO - Encoded column: y
2024-11-02 05:01:36,924 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 05:01:37,012 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:01:37,019 - INFO - Categorical encoding process completed successfully
2024-11-02 05:02:00,777 - INFO - Starting correlation analysis
2024-11-02 05:02:01,213 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:02:03,630 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:02:04,393 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 05:02:04,435 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 05:02:04,459 - INFO - No highly correlated pairs found.
2024-11-02 05:02:06,942 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:02:06,949 - INFO - Correlation analysis completed successfully
2024-11-02 05:02:20,341 - INFO - Starting SMOTE analysis
2024-11-02 05:02:20,345 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:02:20,388 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:02:20,399 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 05:02:20,481 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 05:02:20,486 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 05:02:20,492 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 05:02:21,171 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 05:02:21,255 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 05:02:21,320 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 05:02:21,339 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 05:02:21,342 - INFO - SMOTE analysis completed successfully
2024-11-02 05:35:59,946 - INFO - Starting data download process
2024-11-02 05:36:02,541 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 05:36:02,609 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 05:36:10,711 - INFO - Starting data loading process
2024-11-02 05:36:10,718 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 05:36:10,758 - INFO - Pickle file loaded successfully
2024-11-02 05:36:11,292 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 05:36:31,890 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 05:36:31,914 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 05:36:31,920 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 05:36:31,927 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 05:36:32,468 - INFO - Generated training data statistics.
2024-11-02 05:36:32,501 - INFO - Inferred schema from training data statistics.
2024-11-02 05:36:32,531 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 05:36:32,903 - INFO - Generated serving data statistics.
2024-11-02 05:36:32,921 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 05:36:33,140 - INFO - Generated training data statistics.
2024-11-02 05:36:33,151 - INFO - Statistics visualization complete.
2024-11-02 05:36:52,267 - INFO - Starting data processing...
2024-11-02 05:36:52,276 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 05:37:00,335 - INFO - Starting data processing
2024-11-02 05:37:00,341 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 05:37:00,511 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 05:37:00,637 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 05:37:00,685 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 05:37:00,722 - INFO - No duplicate rows found.
2024-11-02 05:37:01,600 - INFO - Percentage of null or unknown values in each column:
2024-11-02 05:37:01,604 - INFO - age: 0.00%
2024-11-02 05:37:01,608 - INFO - job: 0.64%
2024-11-02 05:37:01,611 - INFO - marital: 0.00%
2024-11-02 05:37:01,616 - INFO - education: 4.11%
2024-11-02 05:37:01,619 - INFO - default: 0.00%
2024-11-02 05:37:01,622 - INFO - balance: 0.00%
2024-11-02 05:37:01,625 - INFO - housing: 0.00%
2024-11-02 05:37:01,628 - INFO - loan: 0.00%
2024-11-02 05:37:01,633 - INFO - contact: 28.80%
2024-11-02 05:37:01,636 - INFO - day: 0.00%
2024-11-02 05:37:01,639 - INFO - month: 0.00%
2024-11-02 05:37:01,642 - INFO - duration: 0.00%
2024-11-02 05:37:01,645 - INFO - campaign: 0.00%
2024-11-02 05:37:01,650 - INFO - pdays: 0.00%
2024-11-02 05:37:01,653 - INFO - previous: 0.00%
2024-11-02 05:37:01,657 - INFO - poutcome: 81.75%
2024-11-02 05:37:01,660 - INFO - y: 0.00%
2024-11-02 05:37:01,673 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 05:37:01,744 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 05:37:01,799 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 05:37:01,849 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 05:37:01,852 - INFO - Data processing completed successfully
2024-11-02 05:37:42,096 - INFO - Starting EDA process
2024-11-02 05:37:42,106 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 05:37:42,328 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:37:42,361 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 05:37:42,471 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 05:37:42,812 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 05:37:42,836 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 05:37:43,238 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 05:37:43,660 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 05:37:44,026 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 05:37:44,406 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 05:37:44,426 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 05:37:44,908 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 05:37:45,379 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 05:37:45,790 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 05:37:46,142 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 05:37:46,579 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 05:37:47,984 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:37:48,027 - INFO - EDA process completed successfully
2024-11-02 05:38:07,418 - INFO - Starting categorical encoding process
2024-11-02 05:38:07,526 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:38:07,530 - INFO - Column datatypes:
2024-11-02 05:38:07,534 - INFO - age: float64
2024-11-02 05:38:07,537 - INFO - job: string
2024-11-02 05:38:07,539 - INFO - marital: string
2024-11-02 05:38:07,543 - INFO - education: string
2024-11-02 05:38:07,547 - INFO - default: string
2024-11-02 05:38:07,551 - INFO - balance: float64
2024-11-02 05:38:07,553 - INFO - housing: string
2024-11-02 05:38:07,556 - INFO - loan: string
2024-11-02 05:38:07,561 - INFO - contact: string
2024-11-02 05:38:07,565 - INFO - day: float64
2024-11-02 05:38:07,568 - INFO - month: string
2024-11-02 05:38:07,571 - INFO - duration: float64
2024-11-02 05:38:07,575 - INFO - campaign: float64
2024-11-02 05:38:07,579 - INFO - pdays: float64
2024-11-02 05:38:07,582 - INFO - previous: float64
2024-11-02 05:38:07,585 - INFO - y: string
2024-11-02 05:38:07,606 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 05:38:07,634 - INFO - Encoded column: job
2024-11-02 05:38:07,660 - INFO - Encoded column: marital
2024-11-02 05:38:07,686 - INFO - Encoded column: education
2024-11-02 05:38:07,716 - INFO - Encoded column: default
2024-11-02 05:38:07,745 - INFO - Encoded column: housing
2024-11-02 05:38:07,769 - INFO - Encoded column: loan
2024-11-02 05:38:07,798 - INFO - Encoded column: contact
2024-11-02 05:38:07,821 - INFO - Encoded column: month
2024-11-02 05:38:07,846 - INFO - Encoded column: y
2024-11-02 05:38:12,484 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 05:38:13,079 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:38:13,089 - INFO - Categorical encoding process completed successfully
2024-11-02 05:38:33,580 - INFO - Starting correlation analysis
2024-11-02 05:38:33,593 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:38:33,717 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:38:33,819 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 05:38:33,834 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 05:38:33,852 - INFO - No highly correlated pairs found.
2024-11-02 05:38:35,771 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:38:35,779 - INFO - Correlation analysis completed successfully
2024-11-02 05:38:49,586 - INFO - Starting SMOTE analysis
2024-11-02 05:38:49,591 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:38:49,647 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:38:49,663 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 05:38:49,781 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 05:38:49,786 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 05:38:49,793 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 05:38:50,495 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 05:38:50,575 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 05:38:50,650 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 05:38:50,672 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 05:38:50,676 - INFO - SMOTE analysis completed successfully
2024-11-02 05:48:11,913 - INFO - Starting data download process
2024-11-02 05:48:17,597 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 05:48:18,159 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 05:48:32,879 - INFO - Starting data loading process
2024-11-02 05:48:32,888 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 05:48:32,967 - INFO - Pickle file loaded successfully
2024-11-02 05:48:34,031 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 05:48:45,911 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 05:48:46,002 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 05:48:46,032 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 05:48:46,062 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 05:48:46,989 - INFO - Generated training data statistics.
2024-11-02 05:48:47,002 - INFO - Inferred schema from training data statistics.
2024-11-02 05:48:47,020 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 05:48:47,247 - INFO - Generated serving data statistics.
2024-11-02 05:48:47,265 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 05:48:47,508 - INFO - Generated training data statistics.
2024-11-02 05:48:47,519 - INFO - Statistics visualization complete.
2024-11-02 05:49:02,157 - INFO - Starting data processing...
2024-11-02 05:49:02,162 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 05:49:20,582 - INFO - Starting data processing
2024-11-02 05:49:20,590 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 05:49:20,844 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 05:49:21,013 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 05:49:21,088 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 05:49:21,258 - INFO - No duplicate rows found.
2024-11-02 05:49:23,046 - INFO - Percentage of null or unknown values in each column:
2024-11-02 05:49:23,053 - INFO - age: 0.00%
2024-11-02 05:49:23,060 - INFO - job: 0.64%
2024-11-02 05:49:23,067 - INFO - marital: 0.00%
2024-11-02 05:49:23,074 - INFO - education: 4.11%
2024-11-02 05:49:23,082 - INFO - default: 0.00%
2024-11-02 05:49:23,088 - INFO - balance: 0.00%
2024-11-02 05:49:23,095 - INFO - housing: 0.00%
2024-11-02 05:49:23,100 - INFO - loan: 0.00%
2024-11-02 05:49:23,106 - INFO - contact: 28.80%
2024-11-02 05:49:23,126 - INFO - day: 0.00%
2024-11-02 05:49:23,133 - INFO - month: 0.00%
2024-11-02 05:49:23,139 - INFO - duration: 0.00%
2024-11-02 05:49:23,146 - INFO - campaign: 0.00%
2024-11-02 05:49:23,153 - INFO - pdays: 0.00%
2024-11-02 05:49:23,161 - INFO - previous: 0.00%
2024-11-02 05:49:23,168 - INFO - poutcome: 81.75%
2024-11-02 05:49:23,176 - INFO - y: 0.00%
2024-11-02 05:49:23,195 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 05:49:23,316 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 05:49:23,422 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 05:49:23,534 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 05:49:23,541 - INFO - Data processing completed successfully
2024-11-02 05:50:04,455 - INFO - Starting EDA process
2024-11-02 05:50:04,467 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 05:50:04,728 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:50:04,762 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 05:50:04,768 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 05:50:05,109 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 05:50:05,239 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 05:50:05,581 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 05:50:05,955 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 05:50:06,302 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 05:50:06,632 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 05:50:06,661 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 05:50:06,960 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 05:50:07,175 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 05:50:07,465 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 05:50:07,674 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 05:50:07,985 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 05:50:09,133 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:50:09,140 - INFO - EDA process completed successfully
2024-11-02 05:50:26,741 - INFO - Starting categorical encoding process
2024-11-02 05:50:26,957 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 05:50:26,964 - INFO - Column datatypes:
2024-11-02 05:50:26,973 - INFO - age: float64
2024-11-02 05:50:26,979 - INFO - job: string
2024-11-02 05:50:26,984 - INFO - marital: string
2024-11-02 05:50:26,990 - INFO - education: string
2024-11-02 05:50:26,996 - INFO - default: string
2024-11-02 05:50:27,002 - INFO - balance: float64
2024-11-02 05:50:27,009 - INFO - housing: string
2024-11-02 05:50:27,015 - INFO - loan: string
2024-11-02 05:50:27,022 - INFO - contact: string
2024-11-02 05:50:27,028 - INFO - day: float64
2024-11-02 05:50:27,033 - INFO - month: string
2024-11-02 05:50:27,039 - INFO - duration: float64
2024-11-02 05:50:27,044 - INFO - campaign: float64
2024-11-02 05:50:27,050 - INFO - pdays: float64
2024-11-02 05:50:27,057 - INFO - previous: float64
2024-11-02 05:50:27,063 - INFO - y: string
2024-11-02 05:50:27,097 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 05:50:27,144 - INFO - Encoded column: job
2024-11-02 05:50:27,185 - INFO - Encoded column: marital
2024-11-02 05:50:27,231 - INFO - Encoded column: education
2024-11-02 05:50:27,282 - INFO - Encoded column: default
2024-11-02 05:50:27,341 - INFO - Encoded column: housing
2024-11-02 05:50:27,386 - INFO - Encoded column: loan
2024-11-02 05:50:27,442 - INFO - Encoded column: contact
2024-11-02 05:50:27,483 - INFO - Encoded column: month
2024-11-02 05:50:27,528 - INFO - Encoded column: y
2024-11-02 05:50:28,446 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 05:50:28,560 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:50:28,567 - INFO - Categorical encoding process completed successfully
2024-11-02 05:50:45,155 - INFO - Starting correlation analysis
2024-11-02 05:50:45,174 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:50:45,396 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:50:45,594 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 05:50:45,619 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 05:50:45,651 - INFO - No highly correlated pairs found.
2024-11-02 05:50:48,035 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 05:50:48,042 - INFO - Correlation analysis completed successfully
2024-11-02 05:51:04,432 - INFO - Starting SMOTE analysis
2024-11-02 05:51:04,439 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 05:51:04,534 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 05:51:04,568 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 05:51:04,801 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 05:51:04,807 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 05:51:04,818 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 05:51:06,522 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 05:51:06,719 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 05:51:06,853 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 05:51:06,984 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 05:51:06,989 - INFO - SMOTE analysis completed successfully
2024-11-02 06:24:27,917 - INFO - Starting data download process
2024-11-02 06:24:31,414 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 06:24:31,546 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 06:24:41,070 - INFO - Starting data loading process
2024-11-02 06:24:41,078 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 06:24:41,127 - INFO - Pickle file loaded successfully
2024-11-02 06:24:41,814 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 06:25:00,118 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 06:25:00,142 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 06:25:00,149 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 06:25:00,156 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 06:25:00,637 - INFO - Generated training data statistics.
2024-11-02 06:25:00,651 - INFO - Inferred schema from training data statistics.
2024-11-02 06:25:00,670 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 06:25:00,877 - INFO - Generated serving data statistics.
2024-11-02 06:25:00,898 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 06:25:01,129 - INFO - Generated training data statistics.
2024-11-02 06:25:01,143 - INFO - Statistics visualization complete.
2024-11-02 06:25:24,283 - INFO - Starting data processing...
2024-11-02 06:25:24,293 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 06:25:44,408 - INFO - Starting data processing
2024-11-02 06:25:44,429 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 06:25:44,750 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 06:25:45,103 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 06:25:45,414 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 06:25:45,518 - INFO - No duplicate rows found.
2024-11-02 06:25:46,812 - INFO - Percentage of null or unknown values in each column:
2024-11-02 06:25:46,815 - INFO - age: 0.00%
2024-11-02 06:25:46,819 - INFO - job: 0.64%
2024-11-02 06:25:46,823 - INFO - marital: 0.00%
2024-11-02 06:25:46,826 - INFO - education: 4.11%
2024-11-02 06:25:46,829 - INFO - default: 0.00%
2024-11-02 06:25:46,833 - INFO - balance: 0.00%
2024-11-02 06:25:46,837 - INFO - housing: 0.00%
2024-11-02 06:25:46,841 - INFO - loan: 0.00%
2024-11-02 06:25:46,844 - INFO - contact: 28.80%
2024-11-02 06:25:46,846 - INFO - day: 0.00%
2024-11-02 06:25:46,850 - INFO - month: 0.00%
2024-11-02 06:25:46,853 - INFO - duration: 0.00%
2024-11-02 06:25:46,856 - INFO - campaign: 0.00%
2024-11-02 06:25:46,858 - INFO - pdays: 0.00%
2024-11-02 06:25:46,861 - INFO - previous: 0.00%
2024-11-02 06:25:46,864 - INFO - poutcome: 81.75%
2024-11-02 06:25:46,866 - INFO - y: 0.00%
2024-11-02 06:25:46,877 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 06:25:46,935 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 06:25:47,006 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 06:25:47,056 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 06:25:47,060 - INFO - Data processing completed successfully
2024-11-02 06:26:24,574 - INFO - Starting EDA process
2024-11-02 06:26:24,578 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 06:26:24,767 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 06:26:25,039 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 06:26:25,087 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 06:26:30,172 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 06:26:30,210 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 06:26:30,835 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 06:26:31,341 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 06:26:32,114 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 06:26:32,581 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 06:26:32,607 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 06:26:33,149 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 06:26:33,638 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 06:26:34,104 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 06:26:34,584 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 06:26:34,981 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 06:26:36,291 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 06:26:36,299 - INFO - EDA process completed successfully
2024-11-02 06:26:47,464 - INFO - Starting categorical encoding process
2024-11-02 06:26:47,611 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 06:26:47,618 - INFO - Column datatypes:
2024-11-02 06:26:47,626 - INFO - age: float64
2024-11-02 06:26:47,631 - INFO - job: string
2024-11-02 06:26:47,636 - INFO - marital: string
2024-11-02 06:26:47,643 - INFO - education: string
2024-11-02 06:26:47,648 - INFO - default: string
2024-11-02 06:26:47,655 - INFO - balance: float64
2024-11-02 06:26:47,661 - INFO - housing: string
2024-11-02 06:26:47,667 - INFO - loan: string
2024-11-02 06:26:47,676 - INFO - contact: string
2024-11-02 06:26:47,682 - INFO - day: float64
2024-11-02 06:26:47,687 - INFO - month: string
2024-11-02 06:26:47,694 - INFO - duration: float64
2024-11-02 06:26:47,702 - INFO - campaign: float64
2024-11-02 06:26:47,709 - INFO - pdays: float64
2024-11-02 06:26:47,715 - INFO - previous: float64
2024-11-02 06:26:47,722 - INFO - y: string
2024-11-02 06:26:47,751 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 06:26:47,799 - INFO - Encoded column: job
2024-11-02 06:26:47,828 - INFO - Encoded column: marital
2024-11-02 06:26:47,857 - INFO - Encoded column: education
2024-11-02 06:26:47,883 - INFO - Encoded column: default
2024-11-02 06:26:47,909 - INFO - Encoded column: housing
2024-11-02 06:26:47,935 - INFO - Encoded column: loan
2024-11-02 06:26:47,961 - INFO - Encoded column: contact
2024-11-02 06:26:47,989 - INFO - Encoded column: month
2024-11-02 06:26:48,017 - INFO - Encoded column: y
2024-11-02 06:26:48,477 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 06:26:48,543 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:26:48,549 - INFO - Categorical encoding process completed successfully
2024-11-02 06:27:07,327 - INFO - Starting correlation analysis
2024-11-02 06:27:07,335 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:27:07,449 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 06:27:07,604 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 06:27:07,630 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 06:27:07,652 - INFO - No highly correlated pairs found.
2024-11-02 06:27:11,549 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 06:27:11,596 - INFO - Correlation analysis completed successfully
2024-11-02 06:27:31,906 - INFO - Starting SMOTE analysis
2024-11-02 06:27:31,913 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:27:31,964 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 06:27:31,976 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 06:27:32,065 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 06:27:32,071 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 06:27:32,077 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 06:27:32,753 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 06:27:32,834 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 06:27:33,003 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 06:27:33,036 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 06:27:33,040 - INFO - SMOTE analysis completed successfully
2024-11-02 06:33:42,103 - INFO - Starting data download process
2024-11-02 06:33:49,024 - INFO - Latest file files/md5/75/4954d29a573fb8ff0a6f327960d9cf downloaded from GCS.
2024-11-02 06:33:49,719 - INFO - File content pickled and saved as /opt/airflow/data/processed/raw_data.pkl.
2024-11-02 06:34:06,722 - INFO - Starting data loading process
2024-11-02 06:34:06,725 - INFO - Using pickle file: /opt/airflow/data/processed/raw_data.pkl
2024-11-02 06:34:06,759 - INFO - Pickle file loaded successfully
2024-11-02 06:34:07,254 - INFO - Data saved as CSV to: /opt/airflow/data/processed/raw_data.csv
2024-11-02 06:34:27,813 - INFO - Loaded data from /opt/airflow/data/processed/raw_data.csv with shape (45211, 17)
2024-11-02 06:34:27,838 - INFO - Prepared training data with shape (27126, 17)
2024-11-02 06:34:27,843 - INFO - Prepared evaluation data with shape (9042, 17)
2024-11-02 06:34:27,849 - INFO - Prepared serving data with shape (9043, 16)
2024-11-02 06:34:28,305 - INFO - Generated training data statistics.
2024-11-02 06:34:28,315 - INFO - Inferred schema from training data statistics.
2024-11-02 06:34:28,338 - INFO - Schema saved to /opt/airflow/data/processed/schema.pbtxt
2024-11-02 06:34:28,610 - INFO - Generated serving data statistics.
2024-11-02 06:34:28,628 - INFO - Schema saved to /opt/airflow/data/processed/schema_serving.pbtxt
2024-11-02 06:34:28,870 - INFO - Generated training data statistics.
2024-11-02 06:34:28,882 - INFO - Statistics visualization complete.
2024-11-02 06:34:50,123 - INFO - Starting data processing...
2024-11-02 06:34:50,127 - ERROR - An error occurred during data processing: name 'generate_and_save_schema' is not defined
2024-11-02 06:35:12,972 - INFO - Starting data processing
2024-11-02 06:35:12,976 - INFO - Input file: /opt/airflow/data/processed/raw_data.csv
2024-11-02 06:35:13,112 - INFO - Data loaded successfully. DataFrame shape: (45211, 17)
2024-11-02 06:35:13,202 - INFO - DataFrame info saved to /opt/airflow/data/processed/dataframe_info.csv
2024-11-02 06:35:13,243 - INFO - DataFrame description saved to /opt/airflow/data/processed/dataframe_description.csv
2024-11-02 06:35:13,276 - INFO - No duplicate rows found.
2024-11-02 06:35:14,028 - INFO - Percentage of null or unknown values in each column:
2024-11-02 06:35:14,032 - INFO - age: 0.00%
2024-11-02 06:35:14,036 - INFO - job: 0.64%
2024-11-02 06:35:14,040 - INFO - marital: 0.00%
2024-11-02 06:35:14,044 - INFO - education: 4.11%
2024-11-02 06:35:14,048 - INFO - default: 0.00%
2024-11-02 06:35:14,052 - INFO - balance: 0.00%
2024-11-02 06:35:14,056 - INFO - housing: 0.00%
2024-11-02 06:35:14,062 - INFO - loan: 0.00%
2024-11-02 06:35:14,066 - INFO - contact: 28.80%
2024-11-02 06:35:14,070 - INFO - day: 0.00%
2024-11-02 06:35:14,073 - INFO - month: 0.00%
2024-11-02 06:35:14,078 - INFO - duration: 0.00%
2024-11-02 06:35:14,082 - INFO - campaign: 0.00%
2024-11-02 06:35:14,086 - INFO - pdays: 0.00%
2024-11-02 06:35:14,090 - INFO - previous: 0.00%
2024-11-02 06:35:14,094 - INFO - poutcome: 81.75%
2024-11-02 06:35:14,098 - INFO - y: 0.00%
2024-11-02 06:35:14,108 - INFO - Dropped features with >80% null or unknown values: ['poutcome']
2024-11-02 06:35:14,158 - INFO - Filled unknown values in 'job' column with mode value: blue-collar
2024-11-02 06:35:14,205 - INFO - Filled unknown values in 'education' column with mode value: secondary
2024-11-02 06:35:14,257 - INFO - Processed data saved as pickle at /opt/airflow/data/processed/processed_data.pkl
2024-11-02 06:35:14,262 - INFO - Data processing completed successfully
2024-11-02 06:35:57,982 - INFO - Starting EDA process
2024-11-02 06:35:57,986 - INFO - Using input file: /opt/airflow/data/processed/outlier_handled_data.pkl
2024-11-02 06:35:58,107 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 06:35:58,121 - INFO - Data head:
    age           job  marital  education default  balance housing loan  contact  day month  duration  campaign  pdays  previous   y
0  58.0    management  married   tertiary      no   2143.0     yes   no  unknown  5.0   may     261.0       1.0   -1.0       0.0  no
1  44.0    technician   single  secondary      no     29.0     yes   no  unknown  5.0   may     151.0       1.0   -1.0       0.0  no
2  33.0  entrepreneur  married  secondary      no      2.0     yes  yes  unknown  5.0   may      76.0       1.0   -1.0       0.0  no
3  47.0   blue-collar  married  secondary      no   1506.0     yes   no  unknown  5.0   may      92.0       1.0   -1.0       0.0  no
4  33.0   blue-collar   single  secondary      no      1.0      no   no  unknown  5.0   may     198.0       1.0   -1.0       0.0  no
2024-11-02 06:35:58,126 - INFO - Current column names: ['age', 'job', 'marital', 'education', 'default', 'balance', 'housing', 'loan', 'contact', 'day', 'month', 'duration', 'campaign', 'pdays', 'previous', 'y']
2024-11-02 06:35:58,279 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/deposit_distribution.png
2024-11-02 06:35:58,291 - INFO - Contact method distribution:
cellular     0.647741
unknown      0.287983
telephone    0.064276
Name: contact, dtype: Float64
2024-11-02 06:35:58,544 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/contact_method_distribution.png
2024-11-02 06:35:58,750 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/housing_loan_distribution.png
2024-11-02 06:35:58,936 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/personal_loan_distribution.png
2024-11-02 06:35:59,100 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/default_status_distribution.png
2024-11-02 06:35:59,214 - INFO - Month distribution:
may    0.304483
jul    0.152507
aug    0.138174
jun    0.118135
nov     0.08781
apr    0.064851
feb    0.058592
jan    0.031032
oct    0.016323
sep    0.012807
mar    0.010551
dec    0.004733
Name: month, dtype: Float64
2024-11-02 06:35:59,468 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/month_distribution.png
2024-11-02 06:35:59,850 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/age_distribution.png
2024-11-02 06:36:00,668 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/job_distribution.png
2024-11-02 06:36:05,213 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/marital_status_distribution.png
2024-11-02 06:36:05,736 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/education_distribution.png
2024-11-02 06:36:07,799 - INFO - Saved plot: /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 06:36:07,897 - INFO - EDA process completed successfully
2024-11-02 06:36:22,412 - INFO - Starting categorical encoding process
2024-11-02 06:36:22,542 - INFO - Loaded data from /opt/airflow/data/processed/outlier_handled_data.pkl with shape (45211, 16)
2024-11-02 06:36:22,547 - INFO - Column datatypes:
2024-11-02 06:36:22,553 - INFO - age: float64
2024-11-02 06:36:22,557 - INFO - job: string
2024-11-02 06:36:22,560 - INFO - marital: string
2024-11-02 06:36:22,563 - INFO - education: string
2024-11-02 06:36:22,566 - INFO - default: string
2024-11-02 06:36:22,570 - INFO - balance: float64
2024-11-02 06:36:22,573 - INFO - housing: string
2024-11-02 06:36:22,576 - INFO - loan: string
2024-11-02 06:36:22,579 - INFO - contact: string
2024-11-02 06:36:22,582 - INFO - day: float64
2024-11-02 06:36:22,586 - INFO - month: string
2024-11-02 06:36:22,589 - INFO - duration: float64
2024-11-02 06:36:22,593 - INFO - campaign: float64
2024-11-02 06:36:22,596 - INFO - pdays: float64
2024-11-02 06:36:22,599 - INFO - previous: float64
2024-11-02 06:36:22,602 - INFO - y: string
2024-11-02 06:36:22,620 - INFO - Identified 9 categorical columns: ['job', 'marital', 'education', 'default', 'housing', 'loan', 'contact', 'month', 'y']
2024-11-02 06:36:22,647 - INFO - Encoded column: job
2024-11-02 06:36:22,673 - INFO - Encoded column: marital
2024-11-02 06:36:22,701 - INFO - Encoded column: education
2024-11-02 06:36:22,725 - INFO - Encoded column: default
2024-11-02 06:36:22,752 - INFO - Encoded column: housing
2024-11-02 06:36:22,779 - INFO - Encoded column: loan
2024-11-02 06:36:22,803 - INFO - Encoded column: contact
2024-11-02 06:36:22,827 - INFO - Encoded column: month
2024-11-02 06:36:22,863 - INFO - Encoded column: y
2024-11-02 06:36:23,284 - INFO - Saved encoded data to CSV file: /opt/airflow/data/processed/encoded_data.csv
2024-11-02 06:36:23,352 - INFO - Saved encoded data to pickle file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:36:23,453 - INFO - Categorical encoding process completed successfully
2024-11-02 06:36:44,249 - INFO - Starting correlation analysis
2024-11-02 06:36:44,259 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:36:44,367 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 06:36:44,421 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.csv
2024-11-02 06:36:44,431 - INFO - Correlation matrix saved to /opt/airflow/data/processed/correlation_matrix.pkl
2024-11-02 06:36:44,441 - INFO - No highly correlated pairs found.
2024-11-02 06:36:50,283 - INFO - Correlation heatmap saved to /opt/airflow/data/processed/eda_plots/correlation_heatmap.png
2024-11-02 06:36:50,290 - INFO - Correlation analysis completed successfully
2024-11-02 06:37:05,871 - INFO - Starting SMOTE analysis
2024-11-02 06:37:05,876 - INFO - Input file: /opt/airflow/data/processed/encoded_data.pkl
2024-11-02 06:37:05,922 - INFO - Loaded data from /opt/airflow/data/processed/encoded_data.pkl with shape (45211, 16)
2024-11-02 06:37:05,936 - INFO - Target variable distribution before SMOTE:
0    0.883015
1    0.116985
Name: y, dtype: float64
2024-11-02 06:37:06,053 - INFO - Shape of training data before SMOTE: (36168, 15)
2024-11-02 06:37:06,057 - INFO - Shape of training data after SMOTE: (63940, 15)
2024-11-02 06:37:06,063 - INFO - Target variable distribution after SMOTE:
0    0.5
1    0.5
Name: y, dtype: float64
2024-11-02 06:37:10,304 - INFO - Saved SMOTE resampled training data to CSV: /opt/airflow/data/processed/smote_resampled_train_data.csv
2024-11-02 06:37:11,636 - INFO - Saved test data to CSV: /opt/airflow/data/processed/test_data.csv
2024-11-02 06:37:12,100 - INFO - Saved SMOTE resampled training data to pickle: /opt/airflow/data/processed/smote_resampled_train_data.pkl
2024-11-02 06:37:12,168 - INFO - Saved test data to pickle: /opt/airflow/data/processed/test_data.pkl
2024-11-02 06:37:12,195 - INFO - SMOTE analysis completed successfully
